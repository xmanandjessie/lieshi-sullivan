var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),PopView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.hide=function(){UIManager.instance.popLayer.removeChild(this)},e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t},e}(egret.DisplayObjectContainer);__reflect(PopView.prototype,"PopView");var LoginPop=function(t){function e(){var e=t.call(this)||this;return e.passStr="888888",e}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this);var i=new CustomImage("resource/assets/asyn/login_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("login_input_bg_png");a.x=StageUtils.SW-a.width>>1,a.y=260,this.addChild(a);var s=Global.createBitmapByName("login_submit_png");s.x=StageUtils.SW-s.width>>1,s.y=435,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitHandler,this),this.txtName=new egret.TextField,this.txtName.width=400,this.txtName.fontFamily="微软雅黑",this.txtName.type=egret.TextFieldType.INPUT,this.txtName.x=(StageUtils.SW-this.txtName.width>>1)+30,this.txtName.y=275,this.txtName.text="请输入帐号",this.txtName.size=24,this.txtName.textColor=8431304,this.txtName.maxChars=20,this.addChild(this.txtName),this.txtPassword=new egret.TextField,this.txtPassword.width=400,this.txtPassword.fontFamily="微软雅黑",this.txtPassword.type=egret.TextFieldType.INPUT,this.txtPassword.x=(StageUtils.SW-this.txtPassword.width>>1)+30,this.txtPassword.y=360,this.txtPassword.text="请输入密码",this.txtPassword.size=24,this.txtPassword.textColor=8431304,this.txtPassword.maxChars=20,this.txtPassword.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtPassword),this.txtName.addEventListener(egret.FocusEvent.FOCUS_IN,this.nameFocusInHandler,this),this.txtName.addEventListener(egret.FocusEvent.FOCUS_OUT,this.nameFocusOutHandler,this),this.txtPassword.addEventListener(egret.FocusEvent.FOCUS_IN,this.passFocusInHandler,this),this.txtPassword.addEventListener(egret.FocusEvent.FOCUS_OUT,this.passFocusOutHandler,this)},e.prototype.changePWHandler=function(){PopManager.showPop("ChangePWPop")},e.prototype.changeIDHandler=function(){PopManager.showPop("ChangeIDPop")},e.prototype.nameFocusInHandler=function(){"请输入帐号"==this.txtName.text&&(this.txtName.text="")},e.prototype.nameFocusOutHandler=function(){""==this.txtName.text&&(this.txtName.text="请输入帐号")},e.prototype.passFocusInHandler=function(){"请输入密码"==this.txtPassword.text?(this.txtPassword.text="",this.txtPassword.displayAsPassword=!0):this.txtPassword.displayAsPassword=!1},e.prototype.passFocusOutHandler=function(){""==this.txtPassword.text?(this.txtPassword.text="请输入密码",this.txtPassword.displayAsPassword=!1):this.txtPassword.displayAsPassword=!0},e.prototype.passChangeHandler=function(t){var e=t.target.text,i=e.length;e=e.replace(/\*/g,""),this.passStr+=e,this.passStr=this.passStr.substr(0,i),e="";for(var a=0;i>a;a++)e+="*";this.txtPassword1.text=e,console.log(this.passStr)},e.prototype.submitHandler=function(){var t=this.txtName.text.trim(),e=this.txtPassword.text.trim();if(t&&"请输入密码"!=t&&e&&"请输入密码"!=e){var i=this;$.ajax({url:Main.ROOT+"cs/login",data:{eid:Main.EID,scankey:Main.USER_TICKET,user:t,pass:e},success:function(e){"success"==e.state&&e.data&&e.data.eid&&e.data.loginkey?(Global.setItem("login_key",e.data.loginkey),Global.setItem("login_user",t),i.loginOK()):Message.show(e.error)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}else Message.show("请完整填写账号和密码")},e.prototype.loginOK=function(){PopManager.hidePop("LoginPop"),PopManager.showPop("ListPop")},e}(PopView);__reflect(LoginPop.prototype,"LoginPop");var ConfimPayPop=function(_super){function ConfimPayPop(){var t=_super.call(this)||this;return t.allCount=0,t.allPrice=0,t.idList=[],t.dic={},t}return __extends(ConfimPayPop,_super),ConfimPayPop.prototype.setData=function(t){_super.prototype.setData.call(this,t);var e=new egret.Shape;e.graphics.beginFill(16777215),e.graphics.drawRect(0,0,StageUtils.SW,StageUtils.SH),e.graphics.endFill(),this.addChild(e);var i=Global.createBitmapByName("back_png");i.x=20,i.y=20,this.addChild(i),Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("ConfimPayPop"),PopManager.showPop("ListPop")},this);var a=Global.createBitmapByName("confim_order_title_png");a.x=StageUtils.SW-a.width>>1,a.y=40,this.addChild(a);for(var s=t.length,n=0;s>n;n++){var o=t[n];o&&(this.couponkey=o.couponkey,this.idList.push(o.codekey),this.dic[o.name]||(this.dic[o.name]=[]),this.dic[o.name].push(o))}s=this.dic.length;var r=0;for(var h in this.dic){var l=new ConfimPayItem;l.x=StageUtils.SW-600>>1,l.y=105+147*r,l.setData(this.dic[h]),this.addChild(l),r++,this.allCount+=l.len,this.allPrice+=l.price}var d=Global.createBitmapByName("down_bg_png");d.x=0,d.y=StageUtils.SH-d.height,this.addChild(d);var p=new egret.TextField;p.x=30,p.y=StageUtils.SH-55,p.text="总量:"+this.allCount+"盒",p.textColor=0,p.size=22,this.addChild(p);var c=new egret.TextField;c.x=180,c.y=StageUtils.SH-55,c.text="总计:",c.textColor=0,c.size=22,this.addChild(c);var u=new egret.TextField;u.x=230,u.y=StageUtils.SH-63,u.text="￥"+this.allPrice,u.textColor=16730368,u.size=33,this.addChild(u);var g=Global.createBitmapByName("btn_pay_1_png");g.x=StageUtils.SW-g.width,g.y=StageUtils.SH-g.height,this.addChild(g),Global.setBut(g),g.addEventListener(egret.TouchEvent.TOUCH_TAP,this.payTouchHandler,this)},ConfimPayPop.prototype.payTouchHandler=function(){var t=this,e={};e.scankey=Main.USER_TICKET,e.loginkey=Main.LOGIN_KEY,e.eid=Main.EID,e.codekeys=this.idList,e.couponkey=this.couponkey,Global.post("cs/topay",e).then(function(e){void 0!=e.payingnum?"0"==e.payingnum?(t.showPayError(),console.log("支付冲突，请重新选择后再支付")):confirm("有"+e.payingnum+"张支付冲突\n点确定:继续支付其它券折后总价"+e.distotal+"元\n点取消:取消本次支付")?t.sendPay(e.orderkey):t.sendCancel(e.orderkey):t.sendPay(e.orderkey)})["catch"](function(e){console.log("error:"+e),t.showPayError()})},ConfimPayPop.prototype.sendPay=function(orderkey){var _this=this;Global.isinweixin()?Global.post("wxp/"+Main.EID+"/"+orderkey,{scankey:Main.USER_TICKET,loginkey:Main.LOGIN_KEY,eid:Main.EID}).then(function(data){var weixin=eval("wx");weixin.chooseWXPay({appId:data.wxpayjsparams.appId,timestamp:data.wxpayjsparams.timeStamp,nonceStr:data.wxpayjsparams.nonceStr,"package":data.wxpayjsparams["package"],signType:"HMACSHA256",paySign:data.wxpayjsparams.paySign,success:function(t){PopManager.hidePop("ConfimPayPop"),PopManager.showPop("PayOKPop",{price:_this.allPrice})},fail:function(t){alert("微信支付失败["+t.err_msg+"]"),_this.sendCancel(orderkey)},cancel:function(t){_this.sendCancel(orderkey)}})})["catch"](function(t){}):Global.isinzhifubao()&&(window.location.href=Main.ROOT+"zfb/"+Main.EID+"/"+orderkey)},ConfimPayPop.prototype.sendCancel=function(t){var e=this;Global.post("cs/cancel",{scankey:Main.USER_TICKET,loginkey:Main.LOGIN_KEY,eid:Main.EID,orderkey:t}).then(function(t){console.log("订单已取消"),e.backListPop()})},ConfimPayPop.prototype.backListPop=function(){PopManager.hidePop("ConfimPayPop"),PopManager.showPop("ListPop")},ConfimPayPop.prototype.showPayError=function(){var t=this;PopManager.showPop("TipsPop",{url:"tips_error_png",callback:function(){t.backListPop()}})},ConfimPayPop}(PopView);__reflect(ConfimPayPop.prototype,"ConfimPayPop");var CustomButton=function(t){function e(e,i,a){void 0===i&&(i=0),void 0===a&&(a=0);var s=t.call(this)||this;return s.bg=Global.createBitmapByName(e),i&&(s.bg.width=i),a&&(s.bg.height=a),s.addChild(s.bg),s.label=new egret.TextField,s.label.fontFamily="微软雅黑",s.label.size=40,s.label.textColor=16777215,s.label.width=s.bg.width,s.label.height=s.bg.height-5,s.label.textAlign=egret.HorizontalAlign.CENTER,s.label.verticalAlign=egret.VerticalAlign.MIDDLE,s.addChild(s.label),s.touchEnabled=!0,Global.setBut(s),s}return __extends(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this.label.text},set:function(t){this.label.text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{set:function(t){t?(this.alpha=1,this.touchEnabled=!0):(this.alpha=.68,this.touchEnabled=!1)},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(CustomButton.prototype,"CustomButton");var CustomCheckBox=function(t){function e(e,i,a){void 0===a&&(a=0);var s=t.call(this)||this;return s.type=e,s.text=i,s.select=a,s.init(),s}return __extends(e,t),e.prototype.init=function(){console.log(),this.icon=Global.createBitmapByName("cbx_"+this.type+"_"+this.select+"_png"),this.addChild(this.icon),this.txtContent=new egret.TextField,this.txtContent.x=50,this.txtContent.text=this.text,this.addChild(this.txtContent),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},e.prototype.clickHandler=function(){this.change(),this.dispatchEventWith(egret.Event.CHANGE)},e.prototype.setSelect=function(t){this.select=t,this.icon.texture=RES.getRes("cbx_"+this.type+"_"+this.select+"_png")},e.prototype.change=function(){this.setSelect(0==this.select?1:0)},e}(egret.DisplayObjectContainer);__reflect(CustomCheckBox.prototype,"CustomCheckBox");var CustomScrollView=function(t){function e(e,i,a){void 0===e&&(e=null),void 0===i&&(i=0),void 0===a&&(a=0);var s=t.call(this,e)||this;return s.offset=i,s.gap=a,s}return __extends(e,t),e.prototype.setScrollLeft=function(e,i){if(void 0===i&&(i=0),console.log(e,this.getMaxScrollLeft()),e<-50+this.gap/2)e=-50;else if(e>50+this.getMaxScrollLeft()-this.gap/2)e=50+this.getMaxScrollLeft();else{var a=Math.round((e-50)/this.gap);console.log(a),e=a*this.gap}t.prototype.setScrollLeft.call(this,e,i)},e}(egret.ScrollView);__reflect(CustomScrollView.prototype,"CustomScrollView");var CustomTabbar=function(t){function e(e,i,a){for(var s=t.call(this)||this,n=0;e>n;n++){var o=Global.createBitmapByName("tabbar_"+(n+1)+"_2_png");o.x=295,o.y=115,s.addChild(o)}return s}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(CustomTabbar.prototype,"CustomTabbar");var CustomTabButton=function(t){function e(e,i,a,s){var n=t.call(this)||this;return n._select=!1,n.w=i,n.h=a,n.bg=new egret.Shape,n.bg.graphics.beginFill(1600721),n.bg.graphics.drawRect(0,0,i,a),n.bg.graphics.endFill(),n.addChild(n.bg),n.txtLable=new egret.TextField,n.txtLable.text=e,n.txtLable.size=s,n.txtLable.x=0,n.txtLable.y=0,n.txtLable.width=i,n.txtLable.height=a,n.txtLable.textAlign="center",n.txtLable.verticalAlign=egret.VerticalAlign.MIDDLE,n.txtLable.textColor=16777215,n.addChild(n.txtLable),n.touchEnabled=!0,n}return __extends(e,t),Object.defineProperty(e.prototype,"select",{get:function(){return this._select},set:function(t){this._select=t,this._select?(this.txtLable.textColor=16777215,this.bg.graphics.clear(),this.bg.graphics.beginFill(1600721),this.bg.graphics.drawRect(0,0,this.w,this.h),this.bg.graphics.endFill()):(this.txtLable.textColor=0,this.bg.graphics.clear(),this.bg.graphics.beginFill(16777215),this.bg.graphics.drawRect(0,0,this.w,this.h),this.bg.graphics.endFill())},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(CustomTabButton.prototype,"CustomTabButton");var HTMLText=function(){function t(){this._fontSize=40;var t=document.getElementById("gameDiv");this.p=document.createElement("p"),t.appendChild(this.p),this.p.style.border="0px",this.p.style.backgroundColor="transparent",this.p.style.position="absolute",this.p.style.fontSize=this.fontSize+"px",this.p.style.display="none",this.p.style.color="#000000",this.p.style.textAlign="center"}return Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize=t,this.p.style.fontSize=this._fontSize+"px"},enumerable:!0,configurable:!0}),t.prototype.setValue=function(t){this.p.style.display="inline",this.p.innerHTML=t},t.prototype.setPosition=function(t,e,i,a){var s=document.body.clientWidth/StageUtils.SW,n=document.body.clientHeight/StageUtils.SH;this.p.style.left=t*s+"px",this.p.style.top=e*n-this.fontSize+"px",this.p.style.width=i*s+"px",this.p.style.height=a*n+"px",this.p.style.display="inline"},t.prototype.show=function(){this.p&&(this.p.style.display="inline")},t.prototype.hide=function(){this.p&&(this.p.style.display="none")},t}();__reflect(HTMLText.prototype,"HTMLText");var QRCode=function(){function t(t){var e=document.getElementById("gameDiv");this.htmlCode=document.createElement("img"),this.htmlCode.src=t,this.htmlCode.style.position="absolute",this.htmlCode.style.display="none",e.appendChild(this.htmlCode)}return t.prototype.showHtmlCode=function(){this.htmlCode&&(this.htmlCode.style.display="inline")},t.prototype.hideHtmlCode=function(){this.htmlCode&&(this.htmlCode.style.display="none")},t.prototype.setPosition=function(t,e,i,a){if(null!=this.htmlCode)if(document.body.clientWidth<document.body.clientHeight){var s=document.body.clientWidth/StageUtils.SW,n=document.body.clientHeight/StageUtils.SH;this.htmlCode.style.width=i*s+"px",this.htmlCode.style.height=a*n+"px",this.htmlCode.style.left=t*s+"px",this.htmlCode.style.top=e*n+"px"}else{var s=document.body.clientWidth/StageUtils.SH,n=document.body.clientHeight/StageUtils.SW;this.htmlCode.style.width=a*s+"px",this.htmlCode.style.height=i*n+"px",this.htmlCode.style.top=(StageUtils.SW-t-i)*n+"px",this.htmlCode.style.left=e*s+"px"}},t.prototype.destroy=function(){this.htmlCode&&(this.htmlCode.parentNode.removeChild(this.htmlCode),this.htmlCode=null)},t}();__reflect(QRCode.prototype,"QRCode");var PopManager=function(){function PopManager(){}return PopManager.showPop=function(pop,data){void 0===data&&(data=null);var view=PopManager.popDic[pop];view?view.setData(data):(view=eval("new "+pop+"()"),view&&view.setData(data),PopManager.popDic[pop]=view),view.show()},PopManager.hidePop=function(t){var e=PopManager.popDic[t];e?(e.hide(),delete PopManager.popDic[t]):console.log(t+":不存在")},PopManager.popDic={},PopManager}();__reflect(PopManager.prototype,"PopManager");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=new CustomImage("resource/assets/asyn/loading_bg.png",!0,function(){t.width=StageUtils.SW,t.height=StageUtils.SH});this.addChild(t),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=StageUtils.SW,this.textField.height=100,this.textField.x=0,this.textField.y=0,this.textField.size=20,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var AudioManager=function(){function t(){}return t.playEffect=function(t){var e=RES.getRes(t);e.play(0,1)},t}();__reflect(AudioManager.prototype,"AudioManager");var CustomImage=function(t){function e(e,i,a){void 0===i&&(i=!0),void 0===a&&(a=null);var s=t.call(this)||this;return s.url=e,s.isEase=i,s.compFunc=a,s.loadBg(),s}return __extends(e,t),e.prototype.reload=function(t,e){void 0===e&&(e=!1),this.url!=t&&(this.url=t,this.isEase=e,this.loadBg())},e.prototype.loadBg=function(){RES.getResByUrl(this.url,this.onLoadComplete,this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.onLoadComplete=function(t){this.texture=t,this.isEase&&(this.alpha=0,egret.Tween.get(this).to({alpha:1},1e3)),this.compFunc&&this.compFunc()},e}(egret.Bitmap);__reflect(CustomImage.prototype,"CustomImage");var ErrorCode=function(){function t(){}return t.TIME_OUT=999,t.NOT_FOUND=404,t.SYSTEM_ERROR=100,t.TICKET_TIME_OUT=1,t.RECEIVED_SELF=2,t.RECEIVED_OTHER=3,t.RECEIVED_ERROR=4,t}();__reflect(ErrorCode.prototype,"ErrorCode");var GameDispatcher=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}(egret.EventDispatcher);__reflect(GameDispatcher.prototype,"GameDispatcher");var Global=function(){function t(){}return t.createBitmapByRes=function(t,e){var i=new egret.Bitmap,a=RES.getRes(t);return console.log("name::"+e+"::"+t),i.texture=a.getTexture(e),i},t.createBitmapByName=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var a=new egret.Bitmap,s=RES.getRes(t);return a.texture=s,a.x=e,a.y=i,a},t.fadeIn=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=1),t.tweenFrom(e,i,a,0,0,s,egret.Ease.cubicOut)},t.fadeOut=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=1),t.tweenToHide(e,i,a,0,0,s,egret.Ease.cubicOut)},t.zoomIn=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=.6),t.tweenFrom(e,i,a,0,0,s,egret.Ease.backOut)},t.zoomOut=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=1.5),t.tweenToHide(e,i,a,0,0,s,egret.Ease.cubicIn)},t.tweenToHide=function(t,e,i,a,s,n,o,r){void 0===r&&(r=0);var h=egret.Tween.get(t),l=t.x,d=t.y;l+=a,d+=s,h.wait(e),h.to({alpha:r,scaleX:n,scaleY:n,x:l,y:d},i,o),h.call(function(){t.parent&&t.parent.removeChild(t)})},t.tweenTo=function(t,e,i,a,s,n,o,r){void 0===n&&(n=1),void 0===o&&(o=1),void 0===r&&(r=egret.Ease.cubicOut);var h=egret.Tween.get(t);h.wait(e),r?h.to({alpha:n,scaleX:o,scaleY:o,x:a,y:s},i,r):h.to({alpha:n,scaleX:o,scaleY:o,x:a,y:s},i)},t.tweenFrom=function(t,e,i,a,s,n,o){var r=egret.Tween.get(t),h=t.x,l=t.y;t.scaleX=t.scaleY=n,t.x=h+a,t.y=l+s,r.wait(e),r.to({alpha:1,scaleX:1,scaleY:1,x:h,y:l},i,o)},t.createMc=function(t,e,i){var a=RES.getRes(t),s=RES.getRes(e),n=new egret.MovieClipDataFactory(a,s),o=new egret.MovieClip(n.generateMovieClipData(i));return o},t.remove=function(t){t&&t.parent&&t.parent.removeChild(t)},t.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},t.getArrayItems=function(t,e){var i=new Array;for(var a in t)i.push(t[a]);for(var s=new Array,n=0;e>n&&i.length>0;n++){var o=Math.floor(Math.random()*i.length);s[n]=i[o],i.splice(o,1)}return s},t.errorTips=function(t){t&&("invalidticket"==t.reason?PopManager.showPop("ErrorPop",ErrorCode.TICKET_TIME_OUT):"invalidticketparam"==t.reason?PopManager.showPop("ErrorPop",ErrorCode.NOT_FOUND):PopManager.showPop("ErrorPop",ErrorCode.SYSTEM_ERROR))},t.showTips=function(t){Message.show(t)},t.getQueryString=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?decodeURIComponent(i[2]):null},t.setItem=function(t,e){void 0!=e&&null!=e&&t&&localStorage.setItem("page_bridge_"+t,JSON.stringify(e))},t.getItem=function(t){if(t){var e;if(e=localStorage.getItem("page_bridge_"+t),void 0!=e&&null!=e&&""!=e)return JSON.parse(e)}},t.isinweixin=function(){return/MicroMessenger/.test(window.navigator.userAgent)?!0:!1},t.isinzhifubao=function(){return/AlipayClient/.test(window.navigator.userAgent)?!0:!1},t.copyToClipboard=function(t){try{var e=document.createElement("input");e.readOnly=!0,e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("Copy"),document.body.removeChild(e)}catch(i){console.log(i),console.log("copy error")}},t.post=function(t,e){return e&&(e.scankey=Main.USER_TICKET,e.loginkey=Main.LOGIN_KEY,e.eid=Main.EID),new Promise(function(i,a){$.ajax({url:Main.ROOT+t,data:e,success:function(t){"success"==t.state?i(t.data):(Message.show(t.error),a(t.error))},error:function(){PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})})},t.getTypeByName=function(e){for(var i=t.names.length,a=0;i>a;a++)if(-1!=e.indexOf(t.names[a]))return a+1;return-1},t.grayMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],t.grayFlilter=[new egret.ColorMatrixFilter(t.grayMatrix)],t.grayFlilter1=[new egret.ColorMatrixFilter([.1,.1,0,0,200,.1,.1,0,0,0,.1,.1,0,0,0,0,0,0,1,0])],t.DM_Filter=[new egret.GlowFilter(1348416,.5,30,30,2,1)],t.GZ_Filter=[new egret.GlowFilter(11588940,.5,30,30,2,1)],t.JZ_Filter=[new egret.GlowFilter(13944964,.5,30,30,2,1)],t.RP_Filter=[new egret.GlowFilter(5029887,.5,30,30,2,1)],t.QP_Filter=[new egret.GlowFilter(10658466,.5,30,30,2,1)],t.AI_Filter=[new egret.GlowFilter(13369344,.5,30,30,2,1)],t.names=["华玥佳礼","煌玥尊礼","星玥臻礼","珀玥臻礼","蛋黄橘皮月"],t}();__reflect(Global.prototype,"Global");var Message=function(t){function e(){var e=t.call(this)||this;return e.bg=Global.createBitmapByName("message_bg_png"),e.bg.y=-10,e.addChild(e.bg),e.txtStr=new egret.TextField,e.txtStr.textColor=16662101,e.txtStr.width=StageUtils.SW,e.txtStr.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtStr),e}return __extends(e,t),e.prototype.show=function(t){this.txtStr.text=t,this.bg.width=this.txtStr.textWidth+50,this.bg.height=this.txtStr.textHeight+20,this.bg.x=StageUtils.SW-this.bg.width>>1,this.y=StageUtils.SH>>1,this.alpha=1,egret.Tween.get(this).wait(1e3).to({y:this.y-100,alpha:0},1e3,egret.Ease.quadIn).call(this.tweenEnd,this)},e.prototype.tweenEnd=function(){this.parent&&(this.parent.removeChild(this),e.pool.push(this))},e.show=function(t){var i;i=e.pool.length>0?e.pool.pop():new e,i&&(i.show(t),UIManager.instance.topLayer.addChild(i))},e.pool=[],e}(egret.DisplayObjectContainer);__reflect(Message.prototype,"Message");var StageUtils=function(){function t(){}return t.registStage=function(e){t.stage=e,t.SW=e.stageWidth,t.SH=e.stageHeight,t.CW=t.SW>>1,t.CH=t.SH>>1,t.LW=window.innerWidth,t.LH=window.innerHeight},t.centerInParentX=function(e,i){void 0===i&&(i=null),e&&(i?e.x=i.width-e.width>>1:e.x=t.stage.stageWidth-e.width>>1)},t.centerInParentY=function(e,i){void 0===i&&(i=null),e&&(i?e.y=i.height-e.height>>1:e.y=t.stage.stageHeight-e.height>>1)},t.centerInParent=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=null),e&&(s?(e.x=(s.width-e.width>>1)+i,e.y=(s.height-e.height>>1)+a):(e.x=(t.stage.stageWidth-e.width>>1)+i,e.y=(t.stage.stageHeight-e.height>>1)+a))},t}();__reflect(StageUtils.prototype,"StageUtils");var ErrorPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage(e.url,!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1});this.addChild(i),e.qr&&(this.htmlCode=new QRCode("resource/assets/asyn/pay_send_ok_code.png"),this.htmlCode.setPosition(e.x,e.y,125,127),this.htmlCode.showHtmlCode())},e}(PopView);__reflect(ErrorPop.prototype,"ErrorPop");var GameView=function(t){function e(){var e=t.call(this)||this;return PopManager.showPop("SelectListPop"),e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(GameView.prototype,"GameView");var TipsPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Global.createBitmapByName(e.url);i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1,this.addChild(i),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this)},e.prototype.touchHandler=function(){PopManager.hidePop("TipsPop"),this.data.callback&&this.data.callback()},e}(PopView);__reflect(TipsPop.prototype,"TipsPop");var ChangeIDPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Global.createBitmapByName("change_id_png");i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1,this.addChild(i);var a=Global.createBitmapByName("btn_change_close_png");a.x=515,a.y=210,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this);var s=Global.createBitmapByName("btn_change_submit_png");s.x=StageUtils.SW-s.width>>1,s.y=(StageUtils.SH-s.height>>1)+195,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitHandler,this),this.btnSubmit=s,this.txtID=new egret.TextField,this.txtID.width=270,this.txtID.fontFamily="微软雅黑",this.txtID.type=egret.TextFieldType.INPUT,this.txtID.x=240,this.txtID.y=375,this.txtID.text="请输入原用户名",this.txtID.size=24,this.txtID.textColor=12830150,this.txtID.maxChars=20,this.addChild(this.txtID),this.txtID.addEventListener(egret.FocusEvent.FOCUS_IN,this.idFocusInHandler,this),this.txtID.addEventListener(egret.FocusEvent.FOCUS_OUT,this.idFocusOutHandler,this),this.txtPW=new egret.TextField,this.txtPW.width=270,this.txtPW.fontFamily="微软雅黑",this.txtPW.type=egret.TextFieldType.INPUT,this.txtPW.x=240,this.txtPW.y=450,this.txtPW.text="请输入密码",this.txtPW.size=24,this.txtPW.textColor=12830150,this.txtPW.maxChars=20,this.txtPW.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtPW),this.txtPW.addEventListener(egret.FocusEvent.FOCUS_IN,this.pwFocusInHandler,this),this.txtPW.addEventListener(egret.FocusEvent.FOCUS_OUT,this.pwFocusOutHandler,this),this.txtNewID=new egret.TextField,this.txtNewID.width=270,this.txtNewID.fontFamily="微软雅黑",this.txtNewID.type=egret.TextFieldType.INPUT,this.txtNewID.x=240,this.txtNewID.y=568,this.txtNewID.text="请输入新用户名",this.txtNewID.size=24,this.txtNewID.textColor=12830150,this.txtNewID.maxChars=20,this.addChild(this.txtNewID),this.txtNewID.addEventListener(egret.FocusEvent.FOCUS_IN,this.newIDFocusInHandler,this),this.txtNewID.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newIDFocusOutHandler,this)},e.prototype.idFocusInHandler=function(){"请输入原用户名"==this.txtID.text&&(this.txtID.text="")},e.prototype.idFocusOutHandler=function(){""==this.txtID.text&&(this.txtID.text="请输入原用户名")},e.prototype.pwFocusInHandler=function(){"请输入密码"==this.txtPW.text?(this.txtPW.text="",this.txtPW.displayAsPassword=!0):this.txtPW.displayAsPassword=!1},e.prototype.pwFocusOutHandler=function(){""==this.txtPW.text?(this.txtPW.text="请输入密码",this.txtPW.displayAsPassword=!1):this.txtPW.displayAsPassword=!0},e.prototype.newIDFocusInHandler=function(){"请输入新用户名"==this.txtNewID.text&&(this.txtNewID.text="")},e.prototype.newIDFocusOutHandler=function(){""==this.txtNewID.text&&(this.txtNewID.text="请输入新用户名")},e.prototype.closeHandler=function(){PopManager.hidePop("ChangeIDPop")},e.prototype.submitHandler=function(){var t=this.txtID.text.trim(),e=this.txtPW.text.trim(),i=this.txtNewID.text.trim();if(t&&"请输入原用户名"!=t)if(e&&"请输入密码"!=e)if(i&&"请输入新用户名"!=i)if(i==t)Message.show("新用户名不得与原用户名相同!");else{var a=this;$.ajax({url:Main.USER_INFO_API,data:{type:"modifyinfo",ticket:Main.USER_TICKET,oldname:t,oldpassword:e,newname:i,newpassword:e},success:function(t){0==t.result?a.showResult(!0):1==t.result?Message.show("用户名或密码错误!"):2==t.result?Message.show("用户名或密码错误!"):3==t.result?Message.show("该用户名已被使用!"):4==t.result?Message.show("很抱歉，您不能修改用户名!"):Message.show("系统异常:"+t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}else Message.show("请输入新用户名!");else Message.show("请输入密码!");else Message.show("请输入原用户名!")},e.prototype.showResult=function(t){this.btnSubmit.visible=!1;var e="";e=t?"change_ok_png":"change_no_png";var i=Global.createBitmapByName(e);i.x=StageUtils.SW-i.width>>1,i.y=this.btnSubmit.y+10,this.addChild(i)},e}(PopView);__reflect(ChangeIDPop.prototype,"ChangeIDPop");var ChangePWPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=Global.createBitmapByName("back_png");a.x=20,a.y=20,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("ChangePWPop"),PopManager.showPop("SelfPop")},this);var s=new CustomImage("resource/assets/asyn/pwd/title.png",!0,function(){s.x=StageUtils.SW-s.width>>1,s.y=50});this.addChild(s);var n=new CustomImage("resource/assets/asyn/pwd/bg.png",!0,function(){n.x=StageUtils.SW-n.width>>1,n.y=150,r.x=n.x+50,r.y=n.y+18,i.txtNewPW.x=n.x+100,i.txtNewPW.y=n.y});this.addChild(n);var o=new CustomImage("resource/assets/asyn/pwd/bg.png",!0,function(){o.x=StageUtils.SW-o.width>>1,o.y=250,h.x=o.x+50,h.y=o.y+18,i.txtNewPW1.x=o.x+100,i.txtNewPW1.y=o.y});this.addChild(o);var r=new CustomImage("resource/assets/asyn/pwd/icon.png",!0,function(){});this.addChild(r);var h=new CustomImage("resource/assets/asyn/pwd/icon.png",!0,function(){});this.addChild(h);var l=new CustomImage("resource/assets/asyn/pwd/btn_ok.png",!0,function(){l.x=StageUtils.SW-l.width>>1,l.y=350});this.addChild(l),Global.setBut(l),l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitHandler,this),this.btnSubmit=l,this.txtNewPW=new egret.TextField,this.txtNewPW.width=270,this.txtNewPW.height=67,this.txtNewPW.verticalAlign="middle",this.txtNewPW.fontFamily="微软雅黑",this.txtNewPW.type=egret.TextFieldType.INPUT,this.txtNewPW.text="请输入新密码",this.txtNewPW.size=24,this.txtNewPW.textColor=12830150,this.txtNewPW.maxChars=20,this.txtNewPW.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtNewPW),this.txtNewPW.addEventListener(egret.FocusEvent.FOCUS_IN,this.newIDFocusInHandler,this),this.txtNewPW.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newIDFocusOutHandler,this),this.txtNewPW1=new egret.TextField,this.txtNewPW1.width=270,this.txtNewPW1.height=67,this.txtNewPW1.verticalAlign="middle",this.txtNewPW1.fontFamily="微软雅黑",this.txtNewPW1.type=egret.TextFieldType.INPUT,this.txtNewPW1.text="请再次输入新密码",this.txtNewPW1.size=24,this.txtNewPW1.textColor=12830150,this.txtNewPW1.maxChars=20,this.txtNewPW1.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtNewPW1),this.txtNewPW1.addEventListener(egret.FocusEvent.FOCUS_IN,this.newID1FocusInHandler,this),this.txtNewPW1.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newID1FocusOutHandler,this)},e.prototype.newIDFocusInHandler=function(){"请输入新密码"==this.txtNewPW.text?(this.txtNewPW.text="",this.txtNewPW.displayAsPassword=!0):this.txtNewPW.displayAsPassword=!1},e.prototype.newIDFocusOutHandler=function(){""==this.txtNewPW.text?(this.txtNewPW.text="请输入新密码",this.txtNewPW.displayAsPassword=!1):this.txtNewPW.displayAsPassword=!0},e.prototype.newID1FocusInHandler=function(){"请再次输入新密码"==this.txtNewPW1.text?(this.txtNewPW1.text="",this.txtNewPW1.displayAsPassword=!0):this.txtNewPW1.displayAsPassword=!1},e.prototype.newID1FocusOutHandler=function(){""==this.txtNewPW1.text?(this.txtNewPW1.text="请再次输入新密码",this.txtNewPW1.displayAsPassword=!1):this.txtNewPW1.displayAsPassword=!0},e.prototype.closeHandler=function(){PopManager.hidePop("ChangePWPop")},e.prototype.submitHandler=function(){var t=this,e=this.txtNewPW.text.trim(),i=this.txtNewPW1.text.trim();e&&"请输入新密码"!=e?i&&"请再次输入新密码"!=i?e!=i?Message.show("两次密码不一致!"):Global.post("cs/cp",{newpass:e}).then(function(e){t.txtNewPW.text="",t.txtNewPW1.text="",Message.show("修改密码成功!")
})["catch"](function(t){Message.show("修改密码失败!")}):Message.show("请再次输入新密码!"):Message.show("请输入新密码!")},e}(PopView);__reflect(ChangePWPop.prototype,"ChangePWPop");var ListItem=function(t){function e(){var e=t.call(this)||this;e._select=!1;var i=new egret.Shape;return i.graphics.beginFill(16382457),i.graphics.drawRect(0,0,StageUtils.SW,50),i.graphics.endFill(),e.addChild(i),e.txtCount=new egret.TextField,e.txtCount.fontFamily="微软雅黑",e.txtCount.textColor=469575,e.txtCount.text="库存紧张",e.txtCount.width=50,e.txtCount.size=19,e.txtCount.x=20,e.txtCount.y=8,e.addChild(e.txtCount),e.imgCheck=Global.createBitmapByName("check_no_png"),e.imgCheck.x=80,e.imgCheck.y=13,e.addChild(e.imgCheck),e.txtName=new egret.TextField,e.txtName.textColor=469575,e.txtName.fontFamily="微软雅黑",e.txtName.text="金秋福运",e.txtName.x=110,e.txtName.y=15,e.txtName.size=27,e.addChild(e.txtName),e.txtCode=new egret.TextField,e.txtCode.textColor=5528422,e.txtCode.fontFamily="微软雅黑",e.txtCode.text="8K98",e.txtCode.x=315,e.txtCode.y=15,e.txtCode.size=24,e.addChild(e.txtCode),e.txtPrice=new egret.TextField,e.txtPrice.textColor=469575,e.txtPrice.fontFamily="微软雅黑",e.txtPrice.text="998",e.txtPrice.x=380,e.txtPrice.y=15,e.txtPrice.size=24,e.txtPrice.width=110,e.txtPrice.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtPrice),e.txtRate=new egret.TextField,e.txtRate.textColor=16730368,e.txtRate.fontFamily="微软雅黑",e.txtRate.text="7折",e.txtRate.x=490,e.txtRate.y=15,e.txtRate.size=24,e.addChild(e.txtRate),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchHandler,e),e}return __extends(e,t),e.prototype.touchHandler=function(){this.data&&"topay"==this.data.status&&(this.select=!this.select,this.select||GameDispatcher.instance.dispatchEventWith("item_cancel"))},Object.defineProperty(e.prototype,"select",{get:function(){return this.data&&this.data.rest?this._select:!1},set:function(t){this._select=t,this._select?this.imgCheck.texture=RES.getRes("check_ok_png"):this.imgCheck.texture=RES.getRes("check_no_png")},enumerable:!0,configurable:!0}),e.prototype.setData=function(t){this.data=t,this.txtName.text=t.name+"",this.txtPrice.text="￥"+t.value,this.txtCode.text=t.code1+"",this.txtRate.text=t.discount+"折/￥"+t.discountedvalue,0==t.rest?(this.txtCount.text="库存不足",this.txtCount.textColor=6710886):t.rest>5?(this.txtCount.text="库存充足",this.txtCount.textColor=26795):(this.txtCount.textColor=16662101,this.txtCount.text="库存紧张"),"topay"==t.status?this.filters=[]:this.filters=Global.grayFlilter,1==t.ischecked&&(this.select=!0),this.imgCheck.visible="topay"==t.status},e}(egret.DisplayObjectContainer);__reflect(ListItem.prototype,"ListItem");var ListPop=function(_super){function ListPop(){var t=_super.call(this)||this;return t.itemList=[],t.isAllSelect=!1,t.itemDataList=[],t}return __extends(ListPop,_super),ListPop.prototype.setData=function(t){_super.prototype.setData.call(this,t);var e=Global.createBitmapByName("list_title_png");e.x=StageUtils.SW-e.width>>1,e.y=0,this.addChild(e);var i=Global.createBitmapByName("btn_help_png");i.x=20,i.y=38,this.addChild(i),Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.helpHandler,this);var a=Global.createBitmapByName("btn_continue_png");a.x=46,a.y=StageUtils.SH-a.height-75,this.addChild(a),Global.setBut(a),a.visible=!1;var s=Global.createBitmapByName("btn_pay_png");s.x=StageUtils.SW-s.width>>1,s.y=StageUtils.SH-s.height-75,this.addChild(s),Global.setBut(s);var n=Global.createBitmapByName("btn_logout_png");n.x=170,n.y=StageUtils.SH-50,this.addChild(n),Global.setBut(n);var o=Global.createBitmapByName("btn_center_png");o.x=StageUtils.SW-o.width-170,o.y=StageUtils.SH-50,this.addChild(o),Global.setBut(o),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.containerHandler,this),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.payHandler,this),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.logoutHandler,this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selfHandler,this),this.container=new egret.DisplayObjectContainer;var r=new egret.ScrollView;r.setContent(this.container),r.horizontalScrollPolicy="off",r.scrollSpeed=.5,this.addChild(r),r.x=0,r.y=93,r.width=StageUtils.SW,r.height=700,this.allSelect=new egret.Sprite,this.allSelect.x=127,this.allSelect.y=StageUtils.SH-220,this.addChild(this.allSelect),this.allSelect.touchEnabled=!0,this.allSelect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.allSelectHandler,this),this.imgSelect=Global.createBitmapByName("check_no_png"),this.allSelect.addChild(this.imgSelect),this.txtSelect=new egret.TextField,this.txtSelect.textColor=2964310,this.txtSelect.text="全选",this.txtSelect.size=26,this.txtSelect.x=35,this.allSelect.addChild(this.txtSelect),this.allSelect.graphics.beginFill(15132390),this.allSelect.graphics.drawRect(0,0,this.allSelect.width,this.allSelect.height),this.allSelect.graphics.endFill();var h=new egret.TextField;h.text="注意：本月饼券暂不支持港澳台、内蒙古、西藏、青海和新疆地区兑换收货",h.textColor=16662101,h.size=18,h.x=StageUtils.SW-h.width>>1,h.y=850,this.addChild(h),h.visible=!1,GameDispatcher.instance.addEventListener("item_cancel",this.itemCancel,this),this.getData()},ListPop.prototype.itemCancel=function(){this.isAllSelect=!1,this.imgSelect.texture=RES.getRes("check_no_png")},ListPop.prototype.helpHandler=function(){PopManager.showPop("TipsPop",{url:"tips_bg_png",callback:function(){}})},ListPop.prototype.allSelectHandler=function(){this.isAllSelect=!this.isAllSelect,this.isAllSelect?this.imgSelect.texture=RES.getRes("check_ok_png"):this.imgSelect.texture=RES.getRes("check_no_png");for(var t=this.itemList.length,e=0;t>e;e++){var i=this.itemList[e];i&&i.data.rest&&"topay"==i.data.status&&(i.select=this.isAllSelect)}},ListPop.prototype.logoutHandler=function(){Global.setItem("login_key",""),PopManager.hidePop("ListPop"),PopManager.showPop("LoginPop")},ListPop.prototype.containerHandler=function(){console.log("sdsfsd");var self=this,weixin=eval("wx");weixin.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(t){var e=t.resultStr,i=e.split("/");self.getDataByCode("h/"+i[i.length-1])},fail:function(t){alert(JSON.stringify(t))}})},ListPop.prototype.payHandler=function(){for(var t=[],e=this.itemList.length,i=0;e>i;i++){var a=this.itemList[i];a&&a.select&&t.push(a.data)}t.length?(PopManager.hidePop("ListPop"),PopManager.showPop("ConfimPayPop",t)):Message.show("请勾选要购买的物品!")},ListPop.prototype.innerData=function(t){for(var e=t.list,i=e.length,a=0;i>a;a++){var s={};s.couponid=t.couponid,s.couponkey=t.couponkey,s.discount=t.discount,s.discountedvalue=t.discountedvalue,s.name=t.name,s.scanedcodekey=t.scanedcodekey,s.shortname=t.shortname,s.value=t.value,s.code1=t.list[a].code1,s.codekey=t.list[a].codekey,s.seq=t.list[a].seq,s.status=t.list[a].status,s.rest=10,this.itemDataList.push(s)}},ListPop.prototype.refreshData=function(t){this.innerData(t);var e=this.itemDataList;this.itemList.length=0,this.container.removeChildren();for(var i=e.length,a=0;i>a;a++){var s=new ListItem;if(s.y=53*a,s.setData(e[a]),this.container.addChildAt(s,0),this.itemList.push(s),a==i-1){var n=Global.createBitmapByName("list_line2_png");n.x=0,n.y=53*a+89,this.container.addChildAt(n,1)}}},ListPop.prototype.getData=function(){var t=this;$.ajax({url:Main.ROOT+"n/rgc",data:{eid:Main.EID,scankey:Main.USER_TICKET,loginkey:Main.LOGIN_KEY},success:function(e){"success"==e.state?t.refreshData(e.data):Message.show(e.error)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){}})},ListPop.prototype.getDataByCode=function(t){var e=this;$.ajax({url:Main.ROOT+"n/rgc",data:{eid:Main.EID,scankey:Main.USER_TICKET,loginkey:Main.LOGIN_KEY},success:function(t){0==t.result?e.refreshData(t.list):1==t.result?Message.show("已支付!"):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},ListPop.prototype.selfHandler=function(){PopManager.hidePop("ListPop"),PopManager.showPop("SelfPop")},ListPop}(PopView);__reflect(ListPop.prototype,"ListPop");var UIManager=function(t){function e(){var e=t.call(this)||this;return e.initLayer(),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.initLayer=function(){this.mainUILayer=new egret.DisplayObjectContainer,this.addChild(this.mainUILayer),this.popLayer=new egret.DisplayObjectContainer,this.addChild(this.popLayer),this.topLayer=new egret.DisplayObjectContainer,this.addChild(this.topLayer)},e.prototype.initMainView=function(){this.gameView=new GameView,this.mainUILayer.addChild(this.gameView)},e}(egret.DisplayObjectContainer);__reflect(UIManager.prototype,"UIManager");var OrderPop=function(t){function e(){var e=t.call(this)||this;return e.orderData={couponum:0,exnum:0,pagedlist:[],paidnum:0,totalitems:0,totalpages:0},e.pageNum=0,e}return __extends(e,t),e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=Global.createBitmapByName("back_png");a.x=20,a.y=20,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("OrderPop"),PopManager.showPop("SelfPop")},this);var s=new CustomImage("resource/assets/asyn/order/title.png",!0,function(){s.x=StageUtils.SW-s.width>>1,s.y=50});this.addChild(s),this.btnDai=new CustomImage("resource/assets/asyn/order/btn1.png",!0,function(){i.btnDai.x=60,i.btnDai.y=120}),this.addChild(this.btnDai),this.btnYi=new CustomImage("resource/assets/asyn/order/btn2.png",!0,function(){i.btnYi.x=215,i.btnYi.y=120}),this.addChild(this.btnYi),this.btnShi=new CustomImage("resource/assets/asyn/order/btn3.png",!0,function(){i.btnShi.x=360,i.btnShi.y=120}),this.addChild(this.btnShi),this.btnLine=new CustomImage("resource/assets/asyn/order/line.png",!0,function(){i.btnLine.x=90,i.btnLine.y=170}),this.addChild(this.btnLine);var n=new CustomImage("resource/assets/asyn/order/line2.png",!0,function(){n.width=StageUtils.SW,n.y=174});this.addChild(n),this.container=new egret.DisplayObjectContainer;var o=new egret.ScrollView(this.container);o.width=StageUtils.SW,o.height=590,o.x=0,o.y=190,o.horizontalScrollPolicy="off",this.addChild(o),this.txtAll=new egret.TextField,this.txtAll.width=400,this.txtAll.x=50,this.txtAll.y=815,this.txtAll.textColor=11184810,this.txtAll.size=26,this.addChild(this.txtAll),this.txtAll.text="总量:-盒  总计:",this.txtAllPrice=new egret.TextField,this.txtAllPrice.width=400,this.txtAllPrice.x=240,this.txtAllPrice.y=807,this.txtAllPrice.textColor=12620626,this.txtAllPrice.size=40,this.addChild(this.txtAllPrice),this.txtAllPrice.text="￥-",this.btnDai.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.changeStatus(0)},this),this.btnYi.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.changeStatus(1)},this),this.btnShi.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.changeStatus(2)},this),Global.setBut(this.btnDai),Global.setBut(this.btnYi),Global.setBut(this.btnShi),this.getData()},e.prototype.changeStatus=function(t){this.status!=t&&(this.status=t,0==this.status?(this.btnDai.reload("resource/assets/asyn/order/btn1_1.png"),this.btnYi.reload("resource/assets/asyn/order/btn2.png"),this.btnShi.reload("resource/assets/asyn/order/btn3.png"),this.btnLine.x=90):1==this.status?(this.btnDai.reload("resource/assets/asyn/order/btn1.png"),this.btnYi.reload("resource/assets/asyn/order/btn2_1.png"),this.btnShi.reload("resource/assets/asyn/order/btn3.png"),this.btnLine.x=240):(this.btnDai.reload("resource/assets/asyn/order/btn1.png"),this.btnYi.reload("resource/assets/asyn/order/btn2.png"),this.btnShi.reload("resource/assets/asyn/order/btn3_1.png"),this.btnLine.x=390),this.refreshData())},e.prototype.refreshData=function(){this.container.removeChildren();for(var t=this.orderData.pagedlist,e=t.length,i=[],a=0;e>a;a++){var s=t[a];(0==this.status&&"i"==s.status||1==this.status&&"d"==s.status||2==this.status&&"i"!=s.status&&"d"!=s.status)&&i.push(s)}e=i.length;for(var n=0,a=0;e>a;a++){var o=new OrderItem;o.setData(i[a]),o.x=20,o.y=145*a,this.container.addChild(o),n+=parseFloat(i[a].distotal)}this.txtAll.text="总量:"+e+"盒  总计:",this.txtAllPrice.text="￥"+n.toFixed(2)},e.prototype.getData=function(){var t=this;Global.post("cs/rhpo",{pagenum:this.pageNum}).then(function(e){t.orderData.couponum=e.couponum,t.orderData.exnum=e.exnum,t.orderData.paidnum=e.paidnum,t.orderData.pagedlist=t.orderData.pagedlist.concat(e.pagedlist),e.totalpages>t.pageNum+1?(t.pageNum++,t.getData()):t.changeStatus(0)})},e}(PopView);__reflect(OrderPop.prototype,"OrderPop");var PayListPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=Global.createBitmapByName("back_png");a.x=20,a.y=20,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("PayListPop"),PopManager.showPop("SelfPop")},this);var s=new CustomImage("resource/assets/asyn/paylist/title.png",!0,function(){s.x=StageUtils.SW-s.width>>1,s.y=50});this.addChild(s),this.btnDai=new CustomImage("resource/assets/asyn/paylist/btn1.png",!0,function(){i.btnDai.x=60,i.btnDai.y=120}),this.addChild(this.btnDai),this.btnYi=new CustomImage("resource/assets/asyn/paylist/btn2.png",!0,function(){i.btnYi.x=215,i.btnYi.y=120}),this.addChild(this.btnYi),this.btnLine=new CustomImage("resource/assets/asyn/order/line.png",!0,function(){i.btnLine.x=90,i.btnLine.y=170}),this.addChild(this.btnLine);var n=new CustomImage("resource/assets/asyn/order/line2.png",!0,function(){n.width=StageUtils.SW,n.y=174});this.addChild(n),this.container=new egret.DisplayObjectContainer,this.addChild(this.container),this.btnDai.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.changeStatus(0)},this),this.btnYi.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.changeStatus(1)},this),Global.setBut(this.btnDai),Global.setBut(this.btnYi),this.changeStatus(e)},e.prototype.changeStatus=function(t){this.status!=t&&(this.status=t,0==this.status?(this.btnDai.reload("resource/assets/asyn/paylist/btn1_1.png"),this.btnYi.reload("resource/assets/asyn/paylist/btn2.png"),this.btnLine.x=90,this.showList()):(this.btnDai.reload("resource/assets/asyn/paylist/btn1.png"),this.btnYi.reload("resource/assets/asyn/paylist/btn2_1.png"),this.btnLine.x=240,this.showDown()))},e.prototype.showList=function(){this.container.removeChildren(),this.pageNum=0,this.orderData={couponum:0,exnum:0,pagedlist:[],paidnum:0,totalitems:0,totalpages:0},this.getData()},e.prototype.showListData=function(){var t=new egret.TextField;t.width=400,t.x=130,t.y=225,t.textColor=0,t.size=26,this.container.addChild(t),t.text="总张数:"+this.orderData.couponum;var e=new egret.TextField;e.width=400,e.x=330,e.y=225,e.textColor=0,e.size=26,this.container.addChild(e),e.text="已激活张数:"+this.orderData.paidnum;var i=new egret.TextField;i.width=400,i.x=330,i.y=250,i.textColor=0,i.size=26,this.container.addChild(i),i.text="已兑换张数:"+this.orderData.exnum,i.visible=!1;var a=new egret.DisplayObjectContainer,s=new egret.ScrollView(a);s.width=StageUtils.SW,s.height=730,s.x=0,s.y=300,s.horizontalScrollPolicy="off",this.container.addChild(s);for(var n=this.orderData.pagedlist,o=n.length,r=[],h=0;o>h;h++){var l=n[h];"d"==l.status&&r.push(l)}o=r.length;for(var h=0;o>h;h++){var d=new PayListItem;d.setData(r[h]),d.x=20,d.y=700*h,a.addChild(d)}},e.prototype.showDown=function(){this.container.removeChildren();var t=new CustomImage("resource/assets/asyn/paylist/btn_down.png",!0,function(){t.x=StageUtils.SW-t.width>>1,t.y=310});this.container.addChild(t),Global.setBut(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){return Global.isinweixin()?void alert("请点击微信APP右上角的菜单，选择复制链接后用浏览器打开复制的链接即可下载(可能需要重新登录)"):Global.isinzhifubao()?void alert("请点击支付宝APP右上角的菜单，选择复制链接后用浏览器打开复制的链接即可下载(可能需要重新登录)"):void window.open(Main.ROOT+"cs/dpo?loginkey="+Main.LOGIN_KEY+"&eid="+Main.EID+"&scankey="+Main.USER_TICKET)},this);var e=new egret.TextField;e.width=StageUtils.SW,e.x=0,e.y=390,e.textAlign="center",e.textColor=11184810,e.size=26,this.container.addChild(e),e.text="(每周一三五更新)"},e.prototype.getData=function(){var t=this;Global.post("cs/rhpo",{pagenum:this.pageNum}).then(function(e){t.orderData.couponum=e.couponum,t.orderData.exnum=e.exnum,t.orderData.paidnum=e.paidnum,t.orderData.pagedlist=t.orderData.pagedlist.concat(e.pagedlist),e.totalpages>t.pageNum+1?(t.pageNum++,t.getData()):t.showListData()})},e}(PopView);__reflect(PayListPop.prototype,"PayListPop");var PayOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/pay_complete_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_complete_png");a.x=StageUtils.SW-a.width>>1,a.y=300,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnHandler,this);var s=new egret.TextField;s.width=400,s.textAlign=egret.HorizontalAlign.CENTER,s.x=StageUtils.SW-400>>1,s.y=175,s.textColor=16777215,s.size=40,this.addChild(s),s.text="￥"+e.price,this.htmlCode=new QRCode("resource/assets/asyn/pay_send_ok_code.png"),this.htmlCode.setPosition(70,433,171,175),this.htmlCode.showHtmlCode()},e.prototype.btnHandler=function(){this.data&&(this.htmlCode.destroy(),PopManager.hidePop("PayOKPop"),PopManager.showPop("SelfPop"))},e}(PopView);__reflect(PayOKPop.prototype,"PayOKPop");var SelectListItem=function(t){function e(){var e=t.call(this)||this,i=new egret.Shape;return i.graphics.beginFill(16382457),i.graphics.drawRect(0,0,StageUtils.SW,97),i.graphics.lineStyle(1,0),i.graphics.moveTo(0,97),i.graphics.lineTo(StageUtils.SW,97),i.graphics.endFill(),e.addChild(i),e.txtName=new egret.TextField,e.txtName.textColor=469575,e.txtName.fontFamily="微软雅黑",e.txtName.text="金秋福运",e.txtName.x=15,e.txtName.y=32,e.txtName.size=27,e.addChild(e.txtName),e.txtCode=new egret.TextField,e.txtCode.textColor=5528422,e.txtCode.fontFamily="微软雅黑",e.txtCode.text="8K98",e.txtCode.x=225,e.txtCode.y=35,e.txtCode.size=24,e.addChild(e.txtCode),e.txtPrice=new egret.TextField,e.txtPrice.textColor=16730368,e.txtPrice.fontFamily="微软雅黑",e.txtPrice.text="998",e.txtPrice.x=300,e.txtPrice.y=35,e.txtPrice.size=24,e.txtPrice.width=110,e.txtPrice.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtPrice),e.txtRate=new egret.TextField,e.txtRate.textColor=469575,e.txtRate.fontFamily="微软雅黑",e.txtRate.text="7折",e.txtRate.x=425,e.txtRate.y=35,e.txtRate.size=24,e.addChild(e.txtRate),e.txtStatus=new egret.TextField,e.txtStatus.textColor=1270430,e.txtStatus.fontFamily="微软雅黑",e.txtStatus.text="已付款",e.txtStatus.x=StageUtils.SW-135,e.txtStatus.y=35,e.txtStatus.width=120,e.txtStatus.size=24,e.txtStatus.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtStatus),e}return __extends(e,t),e.prototype.setData=function(t){this.txtName.text=t.name+"",this.txtPrice.text="￥"+t.price,this.txtCode.text=t.batchcode1+"",this.txtRate.text=t.discount+"折",this.txtStatus.textColor=1270430,this.txtStatus.text="已付款"},e}(egret.DisplayObjectContainer);__reflect(SelectListItem.prototype,"SelectListItem");var SelectListPop=function(_super){function SelectListPop(){var t=_super.call(this)||this;return t.itemList=[],t}return __extends(SelectListPop,_super),SelectListPop.prototype.setData=function(t){_super.prototype.setData.call(this,t);var e=Global.createBitmapByName("select_list_title_png");e.x=StageUtils.SW-e.width>>1,e.y=0,this.addChild(e),this.txtEmail=new egret.TextField,this.txtEmail.textColor=9212833,this.txtEmail.text="您还可以通过关注“华美食品”公众号\r从经销商入口查询付款详情",this.txtEmail.width=600,this.txtEmail.x=20,this.txtEmail.y=StageUtils.SH-100,this.txtEmail.size=24,this.txtEmail.lineSpacing=10,this.txtEmail.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.txtEmail),this.txtEmail.addEventListener(egret.FocusEvent.FOCUS_IN,this.emailFocusInHandler,this),this.txtEmail.addEventListener(egret.FocusEvent.FOCUS_OUT,this.emailFocusOutHandler,this),this.container=new egret.DisplayObjectContainer;var i=new egret.ScrollView;i.setContent(this.container),i.horizontalScrollPolicy="off",i.scrollSpeed=.5,this.addChild(i),i.x=0,i.y=82,i.width=StageUtils.SW,i.height=700,this.getData();var a=Global.createBitmapByName("btn_close_png");a.x=50,a.y=StageUtils.SH-a.height-120,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this);var s=Global.createBitmapByName("btn_select_png");s.x=StageUtils.SW-s.width-50,s.y=StageUtils.SH-s.height-120-7,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectHandler,this);var n=Global.createBitmapByName("select_bg_down_png");n.x=StageUtils.SW-n.width>>1,n.y=StageUtils.SH-n.height,this.addChild(n)},SelectListPop.prototype.selectHandler=function(){PopManager.hidePop("SelectListPop"),PopManager.showPop("SelectPop")},SelectListPop.prototype.closeHandler=function(){var weixin=eval("wx");weixin&&weixin.closeWindow()},SelectListPop.prototype.payHandler=function(){var t=this.txtEmail.text;t&&"请输入邮箱"!=t?Message.show("发送成功!"):Message.show("请输入邮箱!")},SelectListPop.prototype.emailFocusInHandler=function(){"请输入邮箱"==this.txtEmail.text&&(this.txtEmail.text="")},SelectListPop.prototype.emailFocusOutHandler=function(){""==this.txtEmail.text&&(this.txtEmail.text="请输入邮箱")},SelectListPop.prototype.getData=function(){this.refreshData(this.data)},SelectListPop.prototype.refreshData=function(t){if(this.itemList.length=0,this.container.removeChildren(),t)for(var e=t.length,i=0;e>i;i++){var a=new SelectListItem;a.y=100*i,a.setData(t[i]),this.container.addChild(a),this.itemList.push(a)}},SelectListPop}(PopView);__reflect(SelectListPop.prototype,"SelectListPop");var SelfPop=function(t){function e(){var e=t.call(this)||this;return e.orderData={couponum:0,exnum:0,pagedlist:[],paidnum:0,totalitems:0,totalpages:0},e.pageNum=0,e}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/self/bg.png",!0,function(){i.width=StageUtils.SW});this.addChild(i),this.txtAll=new egret.TextField,this.txtAll.width=400,this.txtAll.x=130,this.txtAll.y=275,this.txtAll.textColor=16777215,this.txtAll.size=26,this.addChild(this.txtAll),this.txtAll.text="总张数:-",this.txtJihuo=new egret.TextField,this.txtJihuo.width=400,this.txtJihuo.x=330,this.txtJihuo.y=275,this.txtJihuo.textColor=16777215,this.txtJihuo.size=26,this.addChild(this.txtJihuo),this.txtJihuo.text="已激活张数:-",this.txtDuihuan=new egret.TextField,this.txtDuihuan.width=400,this.txtDuihuan.x=330,this.txtDuihuan.y=300,this.txtDuihuan.textColor=16777215,this.txtDuihuan.size=26,this.addChild(this.txtDuihuan),this.txtDuihuan.text="已兑换张数:-",this.txtDuihuan.visible=!1;var a=new CustomImage("resource/assets/asyn/self/self_wode.png",!0,function(){a.x=60,a.y=485});this.addChild(a);var s=new CustomImage("resource/assets/asyn/self/self_sub.png",!0,function(){s.x=StageUtils.SW-s.width-60,s.y=485});this.addChild(s);var n=new CustomImage("resource/assets/asyn/self/self_list.png",!0,function(){n.x=60,n.y=700});this.addChild(n);var o=new CustomImage("resource/assets/asyn/self/self_download.png",!0,function(){o.x=StageUtils.SW-o.width-60,o.y=700});this.addChild(o);var r=new CustomImage("resource/assets/asyn/self/btn_list.png",!0,function(){r.x=170,r.y=950});this.addChild(r);var h=new CustomImage("resource/assets/asyn/self/btn_changepwd.png",!0,function(){h.x=StageUtils.SW-h.width-170,h.y=950});this.addChild(h),Global.setBut(a),Global.setBut(s),Global.setBut(n),Global.setBut(o),Global.setBut(r),Global.setBut(h),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SelfPop"),PopManager.showPop("OrderPop")},this),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SelfPop"),PopManager.showPop("SubPop")},this),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SelfPop"),PopManager.showPop("PayListPop",0)},this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SelfPop"),PopManager.showPop("PayListPop",1)},this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SelfPop"),PopManager.showPop("ListPop")},this),h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SelfPop"),PopManager.showPop("ChangePWPop")},this),this.getData()},e.prototype.getData=function(){var t=this;Global.post("cs/rhpo",{pagenum:this.pageNum}).then(function(e){t.orderData.couponum=e.couponum,t.orderData.exnum=e.exnum,t.orderData.paidnum=e.paidnum,t.orderData.pagedlist=t.orderData.pagedlist.concat(e.pagedlist),e.totalpages>t.pageNum+1?(t.pageNum++,t.getData()):t.showData()})},e.prototype.showData=function(){this.txtAll.text="总张数:"+this.orderData.couponum,this.txtJihuo.text="已激活张数:"+this.orderData.paidnum,this.txtDuihuan.text="已兑换张数:"+this.orderData.exnum},e.prototype.btnHandler=function(){},e}(PopView);__reflect(SelfPop.prototype,"SelfPop");var SubPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=Global.createBitmapByName("back_png");a.x=20,a.y=20,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SubPop"),PopManager.showPop("SelfPop")},this);var s=new CustomImage("resource/assets/asyn/sub/title.png",!0,function(){s.x=StageUtils.SW-s.width>>1,s.y=50});this.addChild(s);var n=new CustomImage("resource/assets/asyn/sub/bg.png",!0,function(){n.x=StageUtils.SW-n.width>>1,n.y=125});this.addChild(n),this.btnAdd=new CustomImage("resource/assets/asyn/sub/btn_add.png",!0,function(){i.btnAdd.x=StageUtils.SW-i.btnAdd.width>>1,i.btnAdd.y=StageUtils.SH-i.btnAdd.height-70}),this.addChild(this.btnAdd),Global.setBut(this.btnAdd),this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.showPop("CreateSubPop")},this),this.container=new egret.DisplayObjectContainer;var o=new egret.ScrollView(this.container);o.width=StageUtils.SW,o.height=570,o.x=0,o.y=228,o.horizontalScrollPolicy="off",this.addChild(o),this.getData()},e.prototype.refreshData=function(t){this.container.removeChildren();for(var e=t.length,i=0;e>i;i++){var a=new SubItem;a.setData(t[i]),a.x=20,a.y=80*i,this.container.addChild(a)}},e.prototype.getData=function(){var t=this;Global.post("cs/rsas",{}).then(function(e){t.refreshData(e)})},e}(PopView);__reflect(SubPop.prototype,"SubPop");var ConfimPayItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.graphics.beginFill(14606046),this.graphics.drawRect(0,0,600,133),this.graphics.endFill();var e=new egret.TextField;e.x=30,e.y=30,e.textColor=469575,this.addChild(e);var i=new egret.TextField;i.x=250,i.y=30,i.textColor=16730368,this.addChild(i);var a=new egret.TextField;a.x=30,a.y=80,a.textColor=469575,a.text="小计：",a.size=24,this.addChild(a);var s=new egret.TextField;s.x=100,s.y=80,s.textColor=16730368,s.size=24,this.addChild(s),this.len=t.length,this.price=0;for(var n="",o=0;o<this.len;o++)this.price+=parseFloat(t[o].discountedvalue),n=t[o].name;e.text=n+"",i.text="X"+this.len,s.text="￥"+this.price;var r=Global.createBitmapByName("btn_detail_png");r.x=this.width-r.width-30,r.y=46,this.addChild(r),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.detailHandler,this)},e.prototype.detailHandler=function(){this.data&&PopManager.showPop("PayDetailPop",this.data)},e}(egret.Sprite);__reflect(ConfimPayItem.prototype,"ConfimPayItem");var Main=function(_super){function Main(){var t=_super.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(Main,_super),Object.defineProperty(Main,"USER_INFO_API",{get:function(){return Main.ROOT+"info?"+Math.random()},enumerable:!0,configurable:!0}),Object.defineProperty(Main,"PLAY_API",{get:function(){return Main.ROOT+"play?"+Math.random()},enumerable:!0,configurable:!0}),Object.defineProperty(Main,"LOGIN_KEY",{get:function(){return Global.getItem("login_key")},enumerable:!0,configurable:!0}),Main.prototype.onAddToStage=function(t){StageUtils.registStage(this.stage),this.addChild(UIManager.instance),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},Main.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("main")},Main.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName?RES.loadGroup("select"):"select"==t.groupName?(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene()):"main"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},Main.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},Main.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},Main.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},Main.prototype.createGameScene=function(){if(this.getData())if("1"==Global.getQueryString("page"))Global.post("n/rcec",{}).then(function(t){"exchanged"==t.status?PopManager.showPop("HasGetInfoPop"):"topay"==t.status?PopManager.showPop("HasGetBuyPop"):PopManager.showPop("PersonalPop",t)});else{var t=Global.getItem("login_key");t?PopManager.showPop("ListPop"):PopManager.showPop("LoginPop")}},Main.prototype.getData=function(){return Main.USER_TICKET=Global.getQueryString("scankey"),Main.EID=Global.getQueryString("eid"),Main.USER_TICKET?!0:!1},Main.share=function(url,eshareinfo,time){if(void 0===eshareinfo&&(eshareinfo=null),void 0===time&&(time=null),eval("$.wxIsReady")){var weixin=eval("wx;");weixin&&weixin.onMenuShareAppMessage({title:"送你一份心意",desc:"点击领取好友送您的月饼与祝福,该月饼券 "+time+" 日前领取有效",link:url,imgUrl:"http://res.leasiondata.cn/lstatic/h/share/share_new.jpg",success:function(){Main.sendShareOK(eshareinfo)},cancel:function(){}})}else setTimeout(function(){Main.share(url,eshareinfo,time)},100)},Main.sendShareOK=function(t){$.ajax({url:Main.USER_INFO_API,data:{type:"esharesuccess",ticket:Main.USER_TICKET,eshareinfo:t},success:function(t){0==t.result||Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},Main.showShare=function(){var weixin=eval("wx");weixin&&weixin.showMenuItems({menuList:["menuItem:share:appMessage"]})},Main.hideShare=function(){var weixin=eval("wx");weixin&&weixin.hideMenuItems({menuList:["menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:QZone","menuItem:favorite","menuItem:openWithQQBrowser","menuItem:openWithSafari","menuItem:share:email"]})
},Main.USER_TICKET="",Main.EID="",Main.ROOT="https://data.jedge.cn/",Main}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var PayDetailItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){var e=new egret.Shape;e.graphics.beginFill(0,.001),e.graphics.drawRect(0,0,510,100),e.graphics.endFill(),this.addChild(e);var i=new egret.TextField;i.x=0,i.y=0,i.textColor=0,this.addChild(i);var a=new egret.TextField;a.x=230,a.y=0,a.textColor=0,this.addChild(a);var s=new egret.TextField;s.x=330,s.y=0,s.textColor=0,s.width=120,s.textAlign=egret.HorizontalAlign.CENTER,this.addChild(s),i.text=t.name+"",a.text=t.code1+"",s.text=t.discountedvalue+""},e}(egret.DisplayObjectContainer);__reflect(PayDetailItem.prototype,"PayDetailItem");var PayDetailPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/pop_bg.png",!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1});this.addChild(i);var a=Global.createBitmapByName("detail_title_png");a.x=StageUtils.SW-a.width>>1,a.y=195,this.addChild(a);var s=Global.createBitmapByName("btn_change_close_png");s.x=530,s.y=100,this.addChild(s);var n=new egret.DisplayObjectContainer,o=new egret.ScrollView(n);o.width=510,o.height=580,o.x=100,o.y=270,this.addChild(o);for(var r=e.length,h=0;r>h;h++){var l=new PayDetailItem;l.setData(e[h]),l.x=0,l.y=30+100*h,n.addChild(l)}this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this)},e.prototype.touchHandler=function(t){var e=t.target;e==this&&PopManager.hidePop("PayDetailPop")},e}(PopView);__reflect(PayDetailPop.prototype,"PayDetailPop");var OrderItem=function(_super){function OrderItem(){return _super.call(this)||this}return __extends(OrderItem,_super),OrderItem.prototype.setData=function(t){var e=this;this.data=t,this.graphics.beginFill(16777215),this.graphics.drawRoundRect(0,0,600,133,20),this.graphics.endFill();var i=new egret.TextField;i.x=30,i.y=30,i.textColor=469575,this.addChild(i);var a=new egret.TextField;a.x=250,a.y=30,a.textColor=16730368,this.addChild(a);var s=new egret.TextField;s.x=30,s.y=80,s.textColor=469575,s.text="小计：",s.size=24,this.addChild(s);var n=new egret.TextField;n.x=100,n.y=80,n.textColor=16730368,n.size=24,this.addChild(n),i.text=t.couponname+"",a.text="X"+t.couponum,n.text="￥"+t.distotal;var o;if("i"==this.data.status){o=new CustomImage("resource/assets/asyn/order/btn_pay.png",!0,function(){o.x=e.width-144-30,o.y=20,o.width=144,o.height=40});var r=new CustomImage("resource/assets/asyn/order/btn_cancel.png",!0,function(){r.x=e.width-144-30,r.y=70,r.width=144,r.height=40});this.addChild(r),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.sendCancel(e.data.orderkey)},this)}else o=Global.createBitmapByName("btn_detail_png"),o.x=this.width-o.width-30,o.y=46,o.visible=!1;this.addChild(o),Global.setBut(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.detailHandler,this)},OrderItem.prototype.detailHandler=function(){this.data&&("i"==this.data.status?this.sendPay(this.data.orderkey):PopManager.showPop("PayDetailPop",this.data))},OrderItem.prototype.sendPay=function(orderkey){var _this=this;Global.post("wxp/"+Main.EID+"/"+orderkey,{}).then(function(data){var weixin=eval("wx");weixin.chooseWXPay({appId:data.wxpayjsparams.appId,timestamp:data.wxpayjsparams.timeStamp,nonceStr:data.wxpayjsparams.nonceStr,"package":data.wxpayjsparams["package"],signType:"HMACSHA256",paySign:data.wxpayjsparams.paySign,success:function(t){PopManager.hidePop("OrderPop"),PopManager.showPop("PayOKPop",{price:_this.data.distotal})},fail:function(t){alert("微信支付失败["+t.err_msg+"]")},cancel:function(t){}})})["catch"](function(t){})},OrderItem.prototype.sendCancel=function(t){Global.post("cs/cancel",{scankey:Main.USER_TICKET,loginkey:Main.LOGIN_KEY,eid:Main.EID,orderkey:t}).then(function(t){console.log("订单已取消"),Message.show("订单已取消"),PopManager.hidePop("OrderPop"),PopManager.showPop("OrderPop")})},OrderItem}(egret.Sprite);__reflect(OrderItem.prototype,"OrderItem");var PayListItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.graphics.beginFill(16777215),this.graphics.drawRoundRect(0,0,600,680,20),this.graphics.endFill();var e=new egret.TextField;e.textColor=11184810,e.text="系统订单号:",e.size=20,e.x=30,e.y=30,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=""+this.data.orderkey,i.x=230,i.y=30,i.size=16,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="礼卷张数:",e.size=20,e.x=30,e.y=80,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=""+this.data.couponum,i.x=230,i.y=80,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="支付方式:",e.size=20,e.x=30,e.y=130,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=""+this.data.from=="z"?"支付宝":"微信",i.x=230,i.y=130,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="经销商名称:",e.size=20,e.x=30,e.y=180,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=""+this.data.agentcompany,i.x=230,i.y=180,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="经销商支付账号:",e.size=20,e.x=30,e.y=230,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=""+this.data.accountuser,i.x=230,i.y=230,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="支付金额:",e.size=20,e.x=30,e.y=280,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=""+this.data.distotal,i.x=230,i.y=280,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="支付状态:",e.size=20,e.x=30,e.y=330,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=""+this.data.status=="d"?"已支付":"未支付",i.x=230,i.y=330,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="折扣:",e.size=20,e.x=30,e.y=380,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=parseFloat(this.data.discount)/10+"折",i.x=230,i.y=380,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="礼卷名称:",e.size=20,e.x=30,e.y=430,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=this.data.couponname+"",i.x=230,i.y=430,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="礼卷ID:",e.size=20,e.x=30,e.y=480,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=this.data.couponid+"",i.x=230,i.y=480,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="下单时间:",e.size=20,e.x=30,e.y=530,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=this.data.createtime+"",i.x=230,i.y=530,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="支付时间:",e.size=20,e.x=30,e.y=580,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=this.data.lastupdatime+"",i.x=230,i.y=580,i.size=20,this.addChild(i);var e=new egret.TextField;e.textColor=11184810,e.text="用户昵称:",e.size=20,e.x=30,e.y=630,this.addChild(e);var i=new egret.TextField;i.textColor=11184810,i.text=this.data.usernick+"",i.x=230,i.y=630,i.size=20,this.addChild(i)},e}(egret.Sprite);__reflect(PayListItem.prototype,"PayListItem");var CreateSubPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=new CustomImage("resource/assets/asyn/sub/create_bg.png",!0,function(){a.x=StageUtils.SW-a.width>>1,a.y=StageUtils.SH-a.height>>1});this.addChild(a);var s=Global.createBitmapByName("btn_change_close_png");s.x=515,s.y=210,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("CreateSubPop")},this),this.btnAdd=new CustomImage("resource/assets/asyn/sub/btn_create.png",!0,function(){i.btnAdd.x=StageUtils.SW-i.btnAdd.width>>1,i.btnAdd.y=(StageUtils.SH-i.btnAdd.height>>1)+120}),this.addChild(this.btnAdd),Global.setBut(this.btnAdd),this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=i.txtNewPW.text.trim(),e=i.txtNewPW1.text.trim();t&&"请输入名称"!=t?e&&"请输入电话"!=e?11!=e.length?Message.show("电话号码格式不正确!"):Global.post("cs/csa",{name:t,phone:e}).then(function(t){Message.show("创建成功!"),PopManager.hidePop("CreateSubPop"),PopManager.hidePop("SubPop"),PopManager.showPop("SubPop")})["catch"](function(t){Message.show("创建失败!")}):Message.show("请输入电话!"):Message.show("请输入名称!")},this);var n=new CustomImage("resource/assets/asyn/sub/input_bg.png",!0,function(){n.x=300,n.y=(StageUtils.SH-n.height>>1)-35,i.txtNewPW.x=n.x+20,i.txtNewPW.y=n.y});this.addChild(n);var o=new CustomImage("resource/assets/asyn/sub/input_bg.png",!0,function(){o.x=300,o.y=(StageUtils.SH-o.height>>1)+30,i.txtNewPW1.x=o.x+20,i.txtNewPW1.y=o.y});this.addChild(o),this.txtNewPW=new egret.TextField,this.txtNewPW.width=270,this.txtNewPW.height=39,this.txtNewPW.verticalAlign="middle",this.txtNewPW.fontFamily="微软雅黑",this.txtNewPW.type=egret.TextFieldType.INPUT,this.txtNewPW.text="请输入名称",this.txtNewPW.size=24,this.txtNewPW.textColor=12830150,this.txtNewPW.maxChars=20,this.addChild(this.txtNewPW),this.txtNewPW.addEventListener(egret.FocusEvent.FOCUS_IN,this.newIDFocusInHandler,this),this.txtNewPW.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newIDFocusOutHandler,this),this.txtNewPW1=new egret.TextField,this.txtNewPW1.width=270,this.txtNewPW1.height=39,this.txtNewPW1.verticalAlign="middle",this.txtNewPW1.fontFamily="微软雅黑",this.txtNewPW1.type=egret.TextFieldType.INPUT,this.txtNewPW1.text="请输入电话",this.txtNewPW1.size=24,this.txtNewPW1.maxChars=11,this.txtNewPW1.restrict="0-9",this.txtNewPW1.textColor=12830150,this.addChild(this.txtNewPW1),this.txtNewPW1.addEventListener(egret.FocusEvent.FOCUS_IN,this.newID1FocusInHandler,this),this.txtNewPW1.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newID1FocusOutHandler,this)},e.prototype.newIDFocusInHandler=function(){"请输入名称"==this.txtNewPW.text&&(this.txtNewPW.text="")},e.prototype.newIDFocusOutHandler=function(){""==this.txtNewPW.text&&(this.txtNewPW.text="请输入名称")},e.prototype.newID1FocusInHandler=function(){"请输入电话"==this.txtNewPW1.text&&(this.txtNewPW1.text="")},e.prototype.newID1FocusOutHandler=function(){""==this.txtNewPW1.text&&(this.txtNewPW1.text="请输入电话")},e}(PopView);__reflect(CreateSubPop.prototype,"CreateSubPop");var SubInfoPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=new egret.Shape;a.graphics.beginFill(15132390),a.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),a.graphics.endFill(),this.addChild(a);var s=Global.createBitmapByName("back_png");s.x=20,s.y=20,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("SubInfoPop"),i.txtReset&&i.txtReset.hide()},this);var n=new CustomImage("resource/assets/asyn/sub/title.png",!0,function(){n.x=StageUtils.SW-n.width>>1,n.y=50});this.addChild(n);var o=new CustomImage("resource/assets/asyn/sub/sub_info_bg.png",!0,function(){o.x=StageUtils.SW-o.width>>1,o.y=110});this.addChild(o);var r=new CustomImage("resource/assets/asyn/sub/input_bg.png",!0,function(){r.x=305,r.y=215,i.txtName.x=r.x+20,i.txtName.y=r.y});this.addChild(r);var h=new CustomImage("resource/assets/asyn/sub/input_bg.png",!0,function(){h.x=305,h.y=350,i.txtPhone.x=h.x+20,i.txtPhone.y=h.y});this.addChild(h),this.txtName=new egret.TextField,this.txtName.width=270,this.txtName.height=39,this.txtName.verticalAlign="middle",this.txtName.fontFamily="微软雅黑",this.txtName.type=egret.TextFieldType.INPUT,this.txtName.size=24,this.txtName.textColor=0,this.txtName.maxChars=20,this.addChild(this.txtName),this.txtID=new egret.TextField,this.txtID.width=270,this.txtID.height=39,this.txtID.verticalAlign="middle",this.txtID.fontFamily="微软雅黑",this.txtID.size=24,this.txtID.textColor=0,this.txtID.x=325,this.txtID.y=260,this.addChild(this.txtID),this.txtPhone=new egret.TextField,this.txtPhone.width=270,this.txtPhone.height=39,this.txtPhone.verticalAlign="middle",this.txtPhone.fontFamily="微软雅黑",this.txtPhone.type=egret.TextFieldType.INPUT,this.txtPhone.size=24,this.txtPhone.maxChars=11,this.txtPhone.restrict="0-9",this.txtPhone.textColor=0,this.addChild(this.txtPhone);var l=new egret.Sprite;l.width=100,l.height=80,l.x=325,l.y=380,this.addChild(l),this.txtStatus=new egret.TextField,this.txtStatus.height=80,this.txtStatus.verticalAlign=egret.VerticalAlign.MIDDLE,this.txtStatus.fontFamily="微软雅黑",this.txtStatus.textColor=0,l.addChild(this.txtStatus);var d=new CustomImage("resource/assets/asyn/sub/btn_arrow.png",!0,function(){d.x=70,d.y=33});l.addChild(d),Global.setBut(l),l.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){"启用"==i.txtStatus.text?i.txtStatus.text="禁用":i.txtStatus.text="启用"},this),this.btnAdd=new CustomImage("resource/assets/asyn/sub/btn_update.png",!0,function(){i.btnAdd.x=70,i.btnAdd.y=455}),this.addChild(this.btnAdd),this.btnReset=new CustomImage("resource/assets/asyn/sub/btn_reset.png",!0,function(){i.btnReset.x=StageUtils.SW-i.btnReset.width-70,i.btnReset.y=455}),this.addChild(this.btnReset),Global.setBut(this.btnAdd),Global.setBut(this.btnReset),this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=i.txtName.text.trim(),e=i.txtPhone.text.trim(),a="启用"==i.txtStatus.text?1:0;t&&"请输入名称"!=t?e&&"请输入电话"!=e?11!=e.length?Message.show("电话号码格式不正确!"):Global.post("cs/msa",{subaccountkey:i.data.subaccountkey,name:t,phone:e,status:a}).then(function(t){Message.show("修改成功!")})["catch"](function(t){Message.show("修改失败!")}):Message.show("请输入电话!"):Message.show("请输入名称!")},this),this.btnReset.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){confirm("密码重置后，该账号下次登录时需使用新密码，确定重置吗？")&&Global.post("cs/rsap",{subaccountkey:i.data.subaccountkey}).then(function(t){Message.show("重置成功!"),i.txtReset=new HTMLText,i.txtReset.setValue("长按复制该子账号的新密码："+t.pass),i.txtReset.setPosition(0,550,StageUtils.SW,80),i.txtReset.fontSize=20,i.txtReset.show()})["catch"](function(t){Message.show("重置失败!")})},this),this.txtName.text=this.data.name+"",this.txtID.text=this.data.user+"",this.txtPhone.text=this.data.phone+"",this.txtStatus.text=1==this.data.status?"启用":"禁用"},e}(PopView);__reflect(SubInfoPop.prototype,"SubInfoPop");var SubItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){var e=this;this.data=t;var i=new CustomImage("resource/assets/asyn/order/line2.png",!0,function(){i.width=600,i.y=0});this.addChild(i);var a=new egret.TextField;a.x=0,a.y=0,a.width=200,a.height=80,a.textAlign="center",a.verticalAlign=egret.VerticalAlign.MIDDLE,a.textColor=471179,this.addChild(a);var s=new egret.TextField;s.x=200,s.y=0,s.width=200,s.height=80,s.textAlign="center",s.verticalAlign=egret.VerticalAlign.MIDDLE,s.textColor=471179,this.addChild(s);var n=new egret.Sprite;n.width=80,n.height=80,n.x=520,this.addChild(n);var o=new CustomImage("resource/assets/asyn/sub/btn_point.png",!0,function(){o.x=26,o.y=37.5});n.addChild(o),Global.setBut(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log("1111"),PopManager.showPop("SubInfoPop",e.data)},this);var r=new egret.Sprite;r.width=100,r.height=80,r.x=450,this.addChild(r);var h=new egret.TextField;h.x=0,h.y=0,h.height=80,h.verticalAlign=egret.VerticalAlign.MIDDLE,h.textColor=471179,r.addChild(h),this.txtStatus=h;var l=new CustomImage("resource/assets/asyn/sub/btn_arrow.png",!0,function(){l.x=60,l.y=33});r.addChild(l),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){"启用"==h.text?e.update(0):e.update(1)},this),a.text=this.data.name+"",s.text=this.data.user+"",this.refreshStatus(this.data.status)},e.prototype.refreshStatus=function(t){1==t?this.txtStatus.text="启用":this.txtStatus.text="禁用"},e.prototype.update=function(t){var e=this;Global.post("cs/msa",{status:t,subaccountkey:this.data.subaccountkey,name:this.data.name,phone:this.data.phone}).then(function(i){e.data.status=t,e.refreshStatus(t)})},e}(egret.Sprite);__reflect(SubItem.prototype,"SubItem");var AddressPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=new CustomImage("resource/assets/asyn/moontype/2/"+Global.getTypeByName(this.data.name)+".jpg",!0,function(){a.width=StageUtils.SW,a.height=StageUtils.SH});this.addChild(a);var s=new CustomImage("resource/assets/asyn/personal/btn_submit.png",!0,function(){s.x=StageUtils.SW-s.width>>1,s.y=StageUtils.SH-130});this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);var n=new CustomImage("resource/assets/asyn/personal/exchange_bg.png",!0,function(){n.x=StageUtils.SW-n.width>>1,n.y=537});this.addChild(n),this.textBg=new CustomImage("resource/assets/asyn/personal/exchange_bg1.png",!0,function(){i.textBg.x=StageUtils.SW-i.textBg.width>>1,i.textBg.y=560}),this.addChild(this.textBg),this.btnDai=new CustomImage("resource/assets/asyn/personal/btn1_1.png",!0,function(){i.btnDai.x=StageUtils.CW-i.btnDai.width,i.btnDai.y=470}),this.addChild(this.btnDai),this.btnYi=new CustomImage("resource/assets/asyn/personal/btn2.png",!0,function(){i.btnYi.x=StageUtils.CW,i.btnYi.y=470}),this.addChild(this.btnYi),this.btnDai.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.changeStatus(0)},this),this.btnYi.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.changeStatus(1)},this),Global.setBut(this.btnDai),Global.setBut(this.btnYi),this.container=new egret.DisplayObjectContainer,this.addChild(this.container);var o=Global.createBitmapByName("btn_info_png");o.x=StageUtils.SW-o.width-20,o.y=20,this.addChild(o),Global.setBut(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.infoHandler,this),this.changeStatus(0)},e.prototype.changeStatus=function(t){this.status!=t&&(this.status=t,0==this.status?(this.btnDai.reload("resource/assets/asyn/personal/btn1_1.png"),this.btnYi.reload("resource/assets/asyn/personal/btn2.png"),this.showOther()):(this.btnDai.reload("resource/assets/asyn/personal/btn1.png"),this.btnYi.reload("resource/assets/asyn/personal/btn2_1.png"),this.showSelf()))},e.prototype.showOther=function(){var t=this;this.container.removeChildren(),this.textBg.reload("resource/assets/asyn/personal/exchange_bg1.png"),this.txtName=new egret.TextField,this.txtName.type=egret.TextFieldType.INPUT,this.txtName.x=230,this.txtName.y=560,this.txtName.width=150,this.txtName.height=50,this.txtName.maxChars=10,this.container.addChild(this.txtName),this.txtPhone=new egret.TextField,this.txtPhone.type=egret.TextFieldType.INPUT,this.txtPhone.x=440,this.txtPhone.y=570,this.txtPhone.width=150,this.txtPhone.height=50,this.txtPhone.maxChars=11,this.txtPhone.restrict="0-9",this.txtPhone.inputType=egret.TextFieldInputType.TEL,this.txtPhone.size=20,this.container.addChild(this.txtPhone),this.txtSheng=new egret.TextField,this.txtSheng.type=egret.TextFieldType.INPUT,this.txtSheng.x=230,this.txtSheng.y=630,this.txtSheng.width=80,this.txtSheng.height=30,this.txtSheng.maxChars=50,this.txtSheng.size=20,this.container.addChild(this.txtSheng),this.txtShi=new egret.TextField,this.txtShi.type=egret.TextFieldType.INPUT,this.txtShi.x=330,this.txtShi.y=630,this.txtShi.width=90,this.txtShi.height=30,this.txtShi.maxChars=10,this.txtShi.size=20,this.container.addChild(this.txtShi),this.txtXian=new egret.TextField,this.txtXian.type=egret.TextFieldType.INPUT,this.txtXian.x=440,this.txtXian.y=630,this.txtXian.width=80,this.txtXian.height=30,this.txtXian.maxChars=10,this.txtXian.size=20,this.container.addChild(this.txtXian),this.txtAddress=new egret.TextField,this.txtAddress.type=egret.TextFieldType.INPUT,this.txtAddress.x=230,this.txtAddress.y=670,this.txtAddress.width=350,this.txtAddress.height=30,this.txtAddress.maxChars=100,this.txtAddress.size=20,this.container.addChild(this.txtAddress),this.txtZhuFu=new egret.TextField,this.txtZhuFu.type=egret.TextFieldType.INPUT,this.txtZhuFu.x=230,this.txtZhuFu.y=730,this.txtZhuFu.width=250,this.txtZhuFu.height=50,this.txtZhuFu.maxChars=50,this.txtZhuFu.size=20,this.container.addChild(this.txtZhuFu),this.txtName1=new egret.TextField,this.txtName1.type=egret.TextFieldType.INPUT,this.txtName1.x=230,this.txtName1.y=820,this.txtName1.width=150,this.txtName1.height=50,this.txtName1.maxChars=10,this.txtName1.size=20,this.container.addChild(this.txtName1),this.txtPhone1=new egret.TextField,this.txtPhone1.type=egret.TextFieldType.INPUT,this.txtPhone1.x=440,this.txtPhone1.y=820,this.txtPhone1.width=150,this.txtPhone1.height=50,this.txtPhone1.maxChars=11,this.txtPhone1.restrict="0-9",this.txtPhone1.inputType=egret.TextFieldInputType.TEL,this.txtPhone1.size=20,this.container.addChild(this.txtPhone1);var e=new CustomImage("resource/assets/asyn/personal/btn_select.png",!0,function(){e.x=486,e.y=730});this.container.addChild(e),Global.setBut(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.showPop("AddressSelectPop",function(e){t.txtZhuFu.text=e+""})},this)},e.prototype.showSelf=function(){this.container.removeChildren(),this.textBg.reload("resource/assets/asyn/personal/exchange_bg2.png"),this.txtName=new egret.TextField,this.txtName.type=egret.TextFieldType.INPUT,this.txtName.x=180,this.txtName.y=555,this.txtName.width=380,this.txtName.height=50,this.txtName.maxChars=10,this.container.addChild(this.txtName),this.txtPhone=new egret.TextField,this.txtPhone.type=egret.TextFieldType.INPUT,this.txtPhone.x=180,this.txtPhone.y=745,this.txtPhone.width=380,this.txtPhone.height=50,this.txtPhone.maxChars=11,this.txtPhone.restrict="0-9",this.txtPhone.inputType=egret.TextFieldInputType.TEL,this.txtPhone.size=30,this.container.addChild(this.txtPhone),this.txtSheng=new egret.TextField,this.txtSheng.type=egret.TextFieldType.INPUT,this.txtSheng.x=180,this.txtSheng.y=630,this.txtSheng.width=100,this.txtSheng.height=30,this.txtSheng.maxChars=50,this.txtSheng.size=20,this.container.addChild(this.txtSheng),this.txtShi=new egret.TextField,this.txtShi.type=egret.TextFieldType.INPUT,this.txtShi.x=310,this.txtShi.y=630,this.txtShi.width=100,this.txtShi.height=30,this.txtShi.maxChars=10,this.txtShi.size=20,this.container.addChild(this.txtShi),this.txtXian=new egret.TextField,this.txtXian.type=egret.TextFieldType.INPUT,this.txtXian.x=423,this.txtXian.y=630,this.txtXian.width=100,this.txtXian.height=30,this.txtXian.maxChars=10,this.txtXian.size=20,this.container.addChild(this.txtXian),this.txtAddress=new egret.TextField,this.txtAddress.type=egret.TextFieldType.INPUT,this.txtAddress.x=180,this.txtAddress.y=695,this.txtAddress.width=380,this.txtAddress.height=30,this.txtAddress.maxChars=100,this.txtAddress.size=20,this.container.addChild(this.txtAddress)},e.prototype.infoHandler=function(){PopManager.hidePop("AddressPop"),PopManager.showPop("InfoPop")},e.prototype.sendExchange=function(t){Global.post("n/exchange",t).then(function(t){alert("兑换成功，可在个人中心里查看发货状态")})},e.prototype.duihuanHandler=function(){if(0==this.status){var t=this.txtName1.text,e=this.txtPhone1.text,i=this.txtSheng.text,a=this.txtShi.text,s=this.txtXian.text,n=this.txtAddress.text,o=this.txtZhuFu.text,r=this.txtName.text,h=this.txtPhone.text;if(r)if(h)if(11!=h.length)Message.show("收件人手机号码 必须11位!");else if(i)if(a)if(s)if(n)if(t)if(e)if(11!=e.length)Message.show("寄件人手机号码 必须11位!");else{if(i=i.replace("广西","广西壮族自治区"),!(this.checkoutAddress(i)&&this.checkoutAddress(a)&&this.checkoutAddress(s)&&this.checkoutAddress(n)))return void Message.show("港澳台、西藏、新疆、甘肃、青海、内蒙古、宁夏除外");if(confirm("确定用以下信息兑换["+this.data.name+"]吗？\n您的姓名："+t+"\n您的手机号："+e+"\n您写给收货人的祝福语："+o+"\n收货地址："+i+" "+a+" "+s+" "+n+"\n收货人姓名："+r+"\n收货人手机号："+h)){var l={};l.recprov=i,l.recity=a,l.recounty=s,l.recstreet=n,l.recontact=r,l.recphone=h,l.couponkeyfrom=this.data.couponkey,l.couponkeyto=this.data.couponkey,l.usermobile=e,l.helloer=t,l.hello=o,this.sendExchange(l)}}else Message.show("寄件人手机号码 不能为空!");else Message.show("寄件人姓名 不能为空!");else Message.show("详细地址 不能为空!");else Message.show("县 不能为空!");else Message.show("市 不能为空!");else Message.show("省份 不能为空!");else Message.show("收件人手机号码 不能为空!");else Message.show("收件人姓名 不能为空!")}else{var t=this.txtName.text,e=this.txtPhone.text,i=this.txtSheng.text,a=this.txtShi.text,s=this.txtXian.text,n=this.txtAddress.text,o="",r=this.txtName.text,h=this.txtPhone.text;if(r)if(h)if(11!=h.length)Message.show("收件人手机号码 必须11位!");else if(i)if(a)if(s)if(n){if(i=i.replace("广西","广西壮族自治区"),!(this.checkoutAddress(i)&&this.checkoutAddress(a)&&this.checkoutAddress(s)&&this.checkoutAddress(n)))return void Message.show("港澳台、西藏、新疆、甘肃、青海、内蒙古、宁夏除外");if(confirm("确定用以下信息兑换["+this.data.name+"]吗？\n您的姓名："+t+"\n您的手机号："+e+"\n收货地址："+i+" "+a+" "+s+" "+n)){var l={};l.recprov=i,l.recity=a,l.recounty=s,l.recstreet=n,l.recontact=r,l.recphone=h,l.couponkeyfrom=this.data.couponkey,l.couponkeyto=this.data.couponkey,l.usermobile=e,l.helloer=t,l.hello=o,this.sendExchange(l)}}else Message.show("详细地址 不能为空!");else Message.show("县 不能为空!");else Message.show("市 不能为空!");else Message.show("省份 不能为空!");else Message.show("收件人手机号码 不能为空!");else Message.show("收件人姓名 不能为空!")}},e.prototype.checkoutAddress=function(t){for(var e=["香港","澳门","台湾","西藏","新疆","甘肃","青海","内蒙古","宁夏"],i=0;i<e.length;i++)if(-1!=t.indexOf(e[i]))return!1;return!0},e}(PopView);__reflect(AddressPop.prototype,"AddressPop");var BuySendOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/pay_send_ok_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_share_3_png");a.x=StageUtils.SW-a.width>>1,a.y=300,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this)},e.prototype.closeHandler=function(){PopManager.hidePop("BuySendOKPop"),PopManager.showPop("InfoPop",2)},e}(PopView);__reflect(BuySendOKPop.prototype,"BuySendOKPop");var BuySendPop=function(_super){function BuySendPop(){var t=_super.call(this)||this;return t.itemList=[],t.setData(),t}return __extends(BuySendPop,_super),BuySendPop.prototype.setData=function(){var t=Global.createBitmapByName("btn_buy_send_png");t.x=StageUtils.SW-t.width>>1,t.y=StageUtils.SH-115,this.addChild(t),Global.setBut(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);var e=new egret.Shape;e.graphics.beginFill(16777215),e.graphics.drawRect(0,106,StageUtils.SW,StageUtils.SH-106-150),e.graphics.endFill(),this.addChild(e);var i=new egret.DisplayObjectContainer,a=new egret.ScrollView(i);a.width=StageUtils.SW,a.height=StageUtils.SH-130-150,a.x=0,a.y=130,a.horizontalScrollPolicy="off",this.addChild(a);for(var s=0;4>s;s++){var n=new BuySendItem(s+1);n.y=0+300*s,i.addChild(n),this.itemList.push(n)}var o=Global.createBitmapByName("p_line_2_png");o.x=0,o.y=StageUtils.SH-150-5,this.addChild(o)},BuySendPop.prototype.duihuanHandler=function(){var type1=this.itemList[0].num,type2=this.itemList[1].num,type3=this.itemList[2].num,type4=this.itemList[3].num;if(!(type1||type2||type3||type4))return void Message.show("没有选中的物品!");var self=this;$.ajax({url:Main.PLAY_API,data:{type:"ecoup",ticket:Main.USER_TICKET,type1:type1,type2:type2,type3:type3,type4:type4},success:function(data){if(0==data.result){var weixin=eval("wx");weixin.chooseWXPay({timestamp:data.timestemps,nonceStr:data.nonce_str,"package":"prepay_id="+data.prepay_id,signType:"MD5",paySign:data.sign,success:function(t){self.payResult(!0,data.payorder)},fail:function(t){self.payResult(!1,data.payorder)},cancel:function(t){self.payResult(!1,data.payorder)}})}else PopManager.showPop("TipsPop",{url:"tips_error_png",callback:function(){}})},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},BuySendPop.prototype.payResult=function(t,e){var i=this;$.ajax({url:Main.PLAY_API,data:{ticket:Main.USER_TICKET,type:"pwxcallback",payorder:e,issuccess:t?1:0,cardtype:"ecoup"},success:function(a){0==a.result&&t?i.share(e):PopManager.showPop("TipsPop",{url:"tips_error_png",callback:function(){}})},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},BuySendPop.prototype.share=function(t){$.ajax({url:Main.USER_INFO_API,data:{type:"eshare",ticket:Main.USER_TICKET,ptype:t},success:function(t){0==t.result?(Main.share("http://lsid.me/h/esharecode$eshareinfo="+t.eshareinfo),PopManager.hidePop("InfoPop"),PopManager.showPop("BuySendOKPop")):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},BuySendPop}(egret.DisplayObjectContainer);__reflect(BuySendPop.prototype,"BuySendPop");var GetShareOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/get_share_ok.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_select_info_png");a.x=StageUtils.SW-a.width>>1,a.y=350,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);$.ajax({url:Main.USER_INFO_API,data:{type:"eshareget",ticket:Main.USER_TICKET,eshareinfo:this.data.payorder},success:function(t){},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},e.prototype.duihuanHandler=function(){PopManager.hidePop("GetShareOKPop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(GetShareOKPop.prototype,"GetShareOKPop");var HasGetBuyPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/personal/tips_bg.jpg",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=new CustomImage("resource/assets/asyn/personal/tips2.png",!0,function(){a.x=StageUtils.SW-a.width>>1,a.y=250});this.addChild(a);var s=new CustomImage("resource/assets/asyn/personal/btn_self.png",!0,function(){s.x=StageUtils.SW-s.width>>1,s.y=360});this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){PopManager.hidePop("HasGetInfoPop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(HasGetBuyPop.prototype,"HasGetBuyPop");var HasGetInfoPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/personal/tips_bg.jpg",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=new CustomImage("resource/assets/asyn/personal/tips1.png",!0,function(){a.x=StageUtils.SW-a.width>>1,a.y=250});this.addChild(a);var s=new CustomImage("resource/assets/asyn/personal/btn_self.png",!0,function(){s.x=StageUtils.SW-s.width>>1,s.y=360
});this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){PopManager.hidePop("HasGetInfoPop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(HasGetInfoPop.prototype,"HasGetInfoPop");var HasGetPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/error/error_yilingqu.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_select_info_png");a.x=StageUtils.SW-a.width>>1,a.y=350,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){PopManager.hidePop("HasGetPop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(HasGetPop.prototype,"HasGetPop");var InfoPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new egret.Shape;i.graphics.beginFill(15132390),i.graphics.drawRect(0,0,StageUtils.SW,StageUtils.SH),i.graphics.endFill(),this.addChildAt(i,0);var a=new CustomImage("resource/assets/asyn/personal/title.png",!0,function(){a.width=StageUtils.SW});this.addChild(a);var s=new CustomImage("resource/assets/asyn/personal/btn_wode.png",!0,function(){s.x=40,s.y=130});this.addChild(s);var n=Global.createBitmapByName("p_line_2_png");n.x=0,n.y=100,this.addChild(n),this.loadData()},e.prototype.showPage=function(t){1==t?this.initOrder():2==t?this.initCard():this.initBuy()},e.prototype.initBuy=function(){this.buyPage=new BuySendPop,this.addChild(this.buyPage)},e.prototype.initCard=function(){if(this.card){this.cardPage=new egret.DisplayObjectContainer,this.addChild(this.cardPage);var t=new egret.Shape;t.graphics.beginFill(16777215),t.graphics.drawRect(0,106,StageUtils.SW,StageUtils.SH-106),t.graphics.endFill(),this.cardPage.addChild(t);var e=Global.createBitmapByName("btn_tips_1_png");e.x=StageUtils.SW-e.width>>1,e.y=130,this.cardPage.addChild(e),Global.setBut(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.showPop("TipsPop",{url:"personal_tips_bg2_png",callback:function(){}})},this);var i=new egret.DisplayObjectContainer,a=new egret.ScrollView(i);a.width=StageUtils.SW,a.height=StageUtils.SH-175,a.x=0,a.y=175,a.horizontalScrollPolicy="off",this.cardPage.addChild(a);var s=0,n=Global.createBitmapByName("card_type_buy_png");n.x=StageUtils.SW-n.width>>1,i.addChild(n),s+=n.height;for(var o=this.card.length,r=0;o>r;r++)if(this.card[r]){var h=new InfoCardItem(this.card[r],r+1,0);h.y=s+25,i.addChild(h),s+=296}var l=Global.createBitmapByName("card_type_get_png");l.x=StageUtils.SW-l.width>>1,l.y=s+25,i.addChild(l),s+=l.height+25;for(var o=this.esharedlist.length,r=0;o>r;r++)if(this.esharedlist[r]&&this.esharedInfo){var d=this.esharedInfo[r];if(d&&d.length){var h=new InfoCardItem(this.esharedlist[r],r+1,1,d[0]);h.y=s+25,i.addChild(h),s+=296}}var p=Global.createBitmapByName("card_type_out_png");p.x=StageUtils.SW-p.width>>1,p.y=s+25,i.addChild(p),s+=p.height+25;for(var o=this.esharelist.length,r=0;o>r;r++)if(this.esharelist[r]){var h=new InfoCardItem(this.esharelist[r],r+1,2);h.y=s+25,i.addChild(h),s+=285}var t=new egret.Shape;t.graphics.beginFill(0,.001),t.graphics.drawRect(0,0,StageUtils.SW,s),t.graphics.endFill(),i.addChildAt(t,0)}},e.prototype.initOrder=function(){if(this.exchange){this.orderPage=new egret.DisplayObjectContainer,this.addChild(this.orderPage);var t=new egret.DisplayObjectContainer,e=new egret.ScrollView(t);e.width=StageUtils.SW,e.height=815,e.x=22,e.y=175,e.horizontalScrollPolicy="off",this.orderPage.addChild(e);var i=new egret.Shape;i.graphics.beginFill(0,.001),i.graphics.drawRect(0,0,30,30),i.graphics.endFill(),t.addChild(i),this.exchange=this.exchange.concat(this.exchange);for(var a=this.exchange.length,s=0;a>s;s++){var n=new InfoOrderItem(this.exchange[s]);n.y=0+368*s,t.addChild(n)}}},e.prototype.duihuanHandler=function(){PopManager.hidePop("InfoPop"),PopManager.showPop("BuySendPop")},e.prototype.loadData=function(){var t=this;Global.post("n/rheo",{pagenum:0}).then(function(e){t.exchange=e.pagedlist,t.initOrder()})},e}(PopView);__reflect(InfoPop.prototype,"InfoPop");var IntoSharePop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);for(var i=e.sharelist,a=i.length,s=0;a>s;s++)if(i[s]){var n=new CustomImage("resource/assets/asyn/moontype/4/"+(s+1)+".png",!0,function(){n.width=StageUtils.SW,n.height=StageUtils.SH});this.addChild(n)}var o=Global.createBitmapByName("btn_share_4_png");o.x=StageUtils.SW-o.width>>1,o.y=StageUtils.SH-235,this.addChild(o),Global.setBut(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);$.ajax({url:Main.USER_INFO_API,data:{type:"eshareget",ticket:Main.USER_TICKET,eshareinfo:this.data.payorder},success:function(t){},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}}),setTimeout(function(){PopManager.showPop("TipsPop",{url:"personal_tips_bg1_png",callback:function(){}})},500)},e.prototype.duihuanHandler=function(){PopManager.hidePop("IntoSharePop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(IntoSharePop.prototype,"IntoSharePop");var MailSelectPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/personal/wuliu_bg.png",!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1});this.addChild(i);var a=Global.createBitmapByName("btn_change_close_png");a.x=538,a.y=100,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("MailSelectPop")},this);var s=new egret.TextField;s.text="快递公司:"+this.data.delcom,s.textColor=10888,s.size=24,s.x=110,s.y=280,this.addChild(s);var n=new egret.TextField;n.text="运单号:"+this.data.delid,n.textColor=10888,n.size=24,n.x=110,n.y=315,this.addChild(n);var o=new CustomImage("resource/assets/asyn/order/line2.png",!0,function(){o.width=465,o.x=StageUtils.SW-o.width>>1,o.y=350});this.addChild(o),this.loadData(e)},e.prototype.loadData=function(t){var e=this;Global.post("n/logi",t).then(function(t){e.container=new egret.DisplayObjectContainer;var i=new egret.ScrollView(e.container);i.width=StageUtils.SW,i.height=470,i.x=0,i.y=410,i.horizontalScrollPolicy="off",e.addChild(i);for(var a=t.length,s=0;a>s;s++){var n=t[s];if(n){var o=new MailItem;o.setData(s,n),o.y=90*s,e.container.addChild(o)}}})},e}(PopView);__reflect(MailSelectPop.prototype,"MailSelectPop");var OrderOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/order_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_buy_gift_png");a.x=StageUtils.SW-a.width>>1,a.y=StageUtils.SH-165,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);var s=new egret.TextField;s.x=0,s.y=200,s.width=StageUtils.SW,s.size=36,s.textAlign=egret.HorizontalAlign.CENTER,s.text=e+"",s.textColor=0,this.addChild(s)},e.prototype.duihuanHandler=function(){PopManager.hidePop("OrderOKPop"),PopManager.showPop("InfoPop",3)},e}(PopView);__reflect(OrderOKPop.prototype,"OrderOKPop");var OtherExchangePop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=new CustomImage("resource/assets/asyn/personal/address_bg.jpg",!0,function(){a.width=StageUtils.SW,a.height=StageUtils.SH});this.addChild(a);var s=new CustomImage("resource/assets/asyn/personal/btn_ok.png",!0,function(){s.x=75,s.y=StageUtils.SH-125});this.addChild(s);var n=new CustomImage("resource/assets/asyn/personal/btn_back.png",!0,function(){n.x=StageUtils.SW-n.width-75,n.y=StageUtils.SH-125});this.addChild(n),Global.setBut(s),Global.setBut(n),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){BuySendItem.selectItem&&(i.data.couponkeyfrom=i.data.couponkey,i.data.couponkeyto=BuySendItem.selectItem.data.couponkey,PopManager.showPop("AddressPop",i.data))},this),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("OtherExchangePop")},this);var o=new egret.DisplayObjectContainer,r=new egret.ScrollView(o);if(r.width=StageUtils.SW,r.height=820,r.x=0,r.y=50,r.horizontalScrollPolicy="off",this.addChild(r),this.data.list)for(var h=this.data.list.length,l=0;h>l;l++){var d=new BuySendItem(this.data.list[l]);d.y=142+280*l,d.x=320,o.addChild(d)}},e}(PopView);__reflect(OtherExchangePop.prototype,"OtherExchangePop");var PersonalPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e),this.initView()},e.prototype.infoHandler=function(){PopManager.hidePop("AddressPop"),PopManager.showPop("InfoPop")},e.prototype.initView=function(){var t=this;document.getElementById("title").innerHTML=this.data.shortname+"-智能礼券支付";var e=new CustomImage("resource/assets/asyn/moontype/1/"+Global.getTypeByName(this.data.name)+".jpg",!0,function(){e.width=StageUtils.SW,e.height=StageUtils.SH});this.addChild(e);var i=Global.createBitmapByName("btn_info_png");i.x=StageUtils.SW-i.width-20,i.y=20,this.addChild(i),Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.infoHandler,this);var a=new CustomImage("resource/assets/asyn/personal/btn_ok"+(this.data.status?"1":"")+".png",!0,function(){if(a.y=StageUtils.SH-a.height/2-150,t.data.list&&t.data.list.length>0){var e=new CustomImage("resource/assets/asyn/personal/btn_other.png",!0,function(){e.x=StageUtils.SW-e.width-50,e.y=StageUtils.SH-e.height/2-150});t.addChild(e),Global.setBut(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,t.otherHandler,t),a.x=50}else a.x=StageUtils.SW-a.width>>1});this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){"offshelf"==this.data.status?(PopManager.showPop("QueHuoPop"),console.log("缺货")):"iscoming"==this.data.status?(PopManager.showPop("QueHuoPop"),console.log("将于"+this.data.timeon+"隆重登场")):"topay"==this.data.status?(console.log("未激活"),PopManager.showPop("HasGetBuyPop"),PopManager.hidePop("PersonalPop")):"exchanged"==this.data.status?(console.log("已兑换"),PopManager.showPop("HasGetInfoPop"),PopManager.hidePop("PersonalPop")):PopManager.showPop("ExchangeConfirmPop",this.data)},e.prototype.otherHandler=function(){PopManager.showPop("OtherExchangePop",this.data)},e.prototype.shareHandler=function(){if(this.data)if(0==this.data.type){$.ajax({url:Main.USER_INFO_API,data:{type:"pshare",ticket:Main.USER_TICKET,ptype:this.data.ptype},success:function(t){0==t.result?(PopManager.hidePop("PersonalPop"),PopManager.showPop("SharePop",{code:t.code})):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}else{$.ajax({url:Main.USER_INFO_API,data:{type:"eshare",ticket:Main.USER_TICKET,ptype:this.data.ptype},success:function(t){0==t.result?(PopManager.hidePop("PersonalPop"),PopManager.showPop("SharePop",{eshareinfo:t.eshareinfo,time:t.sharetime})):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}},e}(PopView);__reflect(PersonalPop.prototype,"PersonalPop");var SharePop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e),Main.showShare();var i=new CustomImage("resource/assets/asyn/share_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i),e&&(e.code?Main.share(e.code):Main.share("http://lsid.me/h/esharecode$eshareinfo="+e.eshareinfo,e.eshareinfo,e.time))},e}(PopView);__reflect(SharePop.prototype,"SharePop");var AddressSelectPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=Global.createBitmapByName("btn_change_close_png");a.x=StageUtils.SW-a.width-30,a.y=30,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("AddressSelectPop")},this),Global.post("n/wish",{}).then(function(t){if(t)for(var e=t.length,a=0;e>a;a++){var s=new egret.TextField;s.width=StageUtils.SW,s.height=30,s.textAlign="center",s.verticalAlign=egret.VerticalAlign.MIDDLE,s.text=t[a].name,s.value=t[a].value,s.size=24,s.x=0,s.y=100+34*a,i.addChildAt(s,1),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.target&&t.target.value&&(i.data&&i.data(t.target.value),PopManager.hidePop("AddressSelectPop"))},i)}})},e}(PopView);__reflect(AddressSelectPop.prototype,"AddressSelectPop");var BuySendItem=function(t){function e(i){var a=t.call(this)||this;a.num=0,a.data=i;var s=Global.getTypeByName(i.name),n=new CustomImage("resource/assets/asyn/moontype/3/"+s+".png",!0,function(){});return n.anchorOffsetX=283.5,n.anchorOffsetY=142,a.addChild(n),a.txtNum=new egret.TextField,a.txtNum.x=-251.5,a.txtNum.y=-122,a.txtNum.textColor=7224330,a.addChild(a.txtNum),a.txtNum.text=Global.names[s-1]+"月饼",Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.selectItem&&e.selectItem.zoomOut(),e.selectItem=a,a.zoom()},a),a}return __extends(e,t),e.prototype.zoom=function(){this.scaleX=1.1,this.scaleY=1.1},e.prototype.zoomOut=function(){this.scaleX=1,this.scaleY=1},e}(egret.DisplayObjectContainer);__reflect(BuySendItem.prototype,"BuySendItem");var ExchangeConfirmPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){var i=this;t.prototype.setData.call(this,e);var a=new CustomImage("resource/assets/asyn/personal/exchange_confirm.png",!0,function(){a.x=StageUtils.SW-a.width>>1,a.y=StageUtils.SH-a.height>>1});this.addChild(a);var s=Global.createBitmapByName("btn_change_close_png");s.x=515,s.y=300,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("ExchangeConfirmPop")},this);var n=new CustomImage("resource/assets/asyn/personal/btn_confirm.png",!0,function(){n.x=StageUtils.SW-n.width>>1,n.y=(StageUtils.SH-n.height>>1)+80});this.addChild(n),Global.setBut(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("PersonalPop"),PopManager.hidePop("ExchangeConfirmPop"),i.data.couponkeyfrom=i.data.couponkey,i.data.couponkeyto=i.data.couponkey,PopManager.showPop("AddressPop",i.data)},this),this.btnSubmit=n},e}(PopView);__reflect(ExchangeConfirmPop.prototype,"ExchangeConfirmPop");var InfoCardItem=function(t){function e(e,i,a,s){void 0===s&&(s=null);var n=t.call(this)||this;n.count=e,n.type=i,n.state=a,n.eshare=s;var o=new CustomImage("resource/assets/asyn/moontype/"+(2==a?8:3)+"/"+i+".png",!0,function(){o.x=StageUtils.SW-o.width>>1});if(n.addChild(o),0==a){var r=Global.createBitmapByName("btn_get1_png");r.x=365,r.y=16,n.addChild(r),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,n.getHandler,n)}else if(1==a){var r=Global.createBitmapByName("btn_get_png");r.x=390,r.y=16,n.addChild(r),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,n.getHandler,n)}var h=Global.createBitmapByName("num_bg_png");return h.x=297,h.y=16,n.addChild(h),n.txtNum=new egret.TextField,n.txtNum.x=300,n.txtNum.y=22,n.txtNum.textAlign=egret.HorizontalAlign.CENTER,n.txtNum.width=54,n.txtNum.textColor=0,n.addChild(n.txtNum),n.txtNum.text=n.count+"",n}return __extends(e,t),e.prototype.getHandler=function(){this.count&&(PopManager.hidePop("InfoPop"),0==this.state?PopManager.showPop("PersonalPop",{type:1,ptype:this.type,isShare:!0}):PopManager.showPop("PersonalPop",{type:1,ptype:this.type,eshare:this.eshare}))},e}(egret.DisplayObjectContainer);__reflect(InfoCardItem.prototype,"InfoCardItem");var InfoOrderItem=function(t){function e(e){var i=t.call(this)||this;i.data=e;var a=new CustomImage("resource/assets/asyn/info_order_item_bg.png",!0,function(){});i.addChild(a);var s=new CustomImage("resource/assets/asyn/personal/btn_wuliu.png",!0,function(){s.x=450,s.y=215});i.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,i.getHandler,i);var n=new egret.TextField;n.x=140,n.y=40,n.textAlign=egret.HorizontalAlign.CENTER,n.textColor=0,n.size=18,i.addChild(n);var o=new egret.TextField;o.x=140,o.y=70,o.textAlign=egret.HorizontalAlign.CENTER,o.textColor=0,o.size=18,i.addChild(o);var r=new egret.TextField;r.x=250,r.y=70,r.textAlign=egret.HorizontalAlign.CENTER,r.textColor=0,r.size=18,i.addChild(r);var h=new egret.TextField;h.x=30,h.y=150,h.textAlign=egret.HorizontalAlign.CENTER,h.textColor=0,h.size=18,i.addChild(h);var l=new egret.TextField;l.x=390,l.y=150,l.textAlign=egret.HorizontalAlign.CENTER,l.textColor=0,l.size=18,i.addChild(l);var d="";(e.recprov||"."!=e.recprov)&&(d=e.recprov);var d="";(e.recprov||"."!=e.recprov)&&(d=e.recprov+"省");var p="";(e.recity||"."!=e.recity)&&(p=e.recity+"市");var c="";(e.recounty||"."!=e.recounty)&&(c=e.recounty+"县/区"),n.text=d+p+c+" "+e.recstreet,o.text=e.recontact+"",r.text=e.recphone+"",i.data.delcomname?(s.visible=!0,h.text="订单号:"+e.delid):(s.visible=!1,h.text="正在打包准备发货，请耐心等待"),l.text=e.lastupdatime+"";var u=new CustomImage("resource/assets/asyn/moontype/5/"+Global.getTypeByName(e.tocouponname)+".png",!0,function(){u.width=144/u.height*u.width,u.height=144});u.x=10,u.y=195,i.addChild(u);var g=new egret.TextField;return g.x=240,g.y=255,g.textColor=76168,i.addChild(g),g.text=e.tocouponname+"月饼",i}return __extends(e,t),e.prototype.getHandler=function(){this.data&&PopManager.showPop("MailSelectPop",{delcom:this.data.delcom,delid:this.data.delid})},e}(egret.DisplayObjectContainer);__reflect(InfoOrderItem.prototype,"InfoOrderItem");var InfoShareItem=function(t){function e(e,i){var a=t.call(this)||this,s=new CustomImage("resource/assets/asyn/moontype/3/"+e+".png",!0,function(){});a.addChild(s);var n=Global.createBitmapByName("num_bg_png");return n.x=420,n.y=20,a.addChild(n),a.txtNum=new egret.TextField,a.txtNum.x=424,a.txtNum.y=26,a.txtNum.textAlign=egret.HorizontalAlign.CENTER,a.txtNum.width=54,a.txtNum.textColor=0,a.addChild(a.txtNum),a.txtNum.text=i+"",a}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(InfoShareItem.prototype,"InfoShareItem");var MailItem=function(t){function e(){var e=t.call(this)||this;e.txtContent=new egret.TextField,e.txtContent.textColor=5658198,e.txtContent.size=20,e.txtContent.x=120,e.txtContent.y=15,e.txtContent.text="",e.addChild(e.txtContent),e.txtTime=new egret.TextField,e.txtTime.textColor=5658198,e.txtTime.size=20,e.txtTime.x=143,e.txtTime.y=55,e.txtTime.text="",e.addChild(e.txtTime);var i=new CustomImage("resource/assets/asyn/order/line2.png",!0,function(){i.width=410,i.x=135,i.y=90});return e.addChild(i),e}return __extends(e,t),e.prototype.setData=function(t,e){0==t?this.txtContent.textColor=10888:this.txtContent.textColor=5658198,this.txtContent.text="●  "+e.address+" "+e.remark,this.txtTime.text=e.time+""},e}(egret.DisplayObjectContainer);__reflect(MailItem.prototype,"MailItem");var QueHuoPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/personal/quehuo.png",!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1});this.addChild(i);var a=new CustomImage("resource/assets/asyn/personal/btn_confirm.png",!0,function(){a.x=StageUtils.SW-a.width>>1,a.y=(StageUtils.SH-a.height>>1)+80});this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.hidePop("QueHuoPop")},this),this.btnSubmit=a},e}(PopView);__reflect(QueHuoPop.prototype,"QueHuoPop");var DetailItem=function(t){function e(){var e=t.call(this)||this,i=new egret.Shape;i.graphics.beginFill(16777215,.001),i.graphics.drawRect(0,0,StageUtils.SW,385),i.graphics.endFill(),e.addChild(i);var a=Global.createBitmapByName("line_2_png");return a.x=0,a.y=380,e.addChild(a),e}return __extends(e,t),e.prototype.setData=function(t,e){this.imgSale=Global.createBitmapByName("select_sale_"+t+"_png"),this.imgSale.x=45,this.imgSale.y=385-this.imgSale.height>>1,this.addChild(this.imgSale);var i=Global.createBitmapByName("line_3_png");i.x=180,i.y=95,this.addChild(i);var i=Global.createBitmapByName("line_3_png");i.x=180,i.y=190,this.addChild(i);var i=Global.createBitmapByName("line_3_png");i.x=180,i.y=285,this.addChild(i);for(var a=e.length,s=0;a>s;s++){var n=new DetailSimpleItem;n.setData(e[s]),n.x=180,n.y=30+97*s,this.addChild(n)}},e}(egret.DisplayObjectContainer);__reflect(DetailItem.prototype,"DetailItem");var DetailSimpleItem=function(t){function e(){var e=t.call(this)||this;return e.txtName=new egret.TextField,e.txtName.x=0,e.txtName.y=0,e.txtName.textColor=469575,e.addChild(e.txtName),e.txtCount=new egret.TextField,e.txtCount.x=180,e.txtCount.y=3,e.txtCount.textColor=469575,e.txtCount.width=100,e.txtCount.textAlign="center",e.txtCount.size=24,e.addChild(e.txtCount),e.txtPrice=new egret.TextField,e.txtPrice.x=310,e.txtPrice.y=3,e.txtPrice.textColor=16730368,e.txtPrice.width=120,e.txtPrice.textAlign="right",e.txtPrice.size=24,e.addChild(e.txtPrice),e}return __extends(e,t),e.prototype.setData=function(t){this.txtName.text=decodeURI(t.name)+"",this.txtCount.text=t.cnt+"",this.txtPrice.text=t.price+""},e}(egret.DisplayObjectContainer);__reflect(DetailSimpleItem.prototype,"DetailSimpleItem");var DetailView=function(t){function e(){var e=t.call(this)||this,i=Global.createBitmapByName("select_title_png");i.x=0,i.y=0,e.addChild(i),e.container=new egret.DisplayObjectContainer;var a=new egret.ScrollView(e.container);a.width=640,a.height=StageUtils.SH-300-90,a.x=0,a.y=64,a.horizontalScrollPolicy="off",e.addChild(a);var s=Global.createBitmapByName("select_down_png");s.x=0,s.y=StageUtils.SH-s.height-240,e.addChild(s);var n=new egret.TextField;n.x=97,n.y=StageUtils.SH-300,n.text="总计：",e.addChild(n);var o=new egret.TextField;o.x=n.x+90,o.y=StageUtils.SH-300,o.textColor=16758400,e.addChild(o);var r=new egret.TextField;r.x=325,r.y=StageUtils.SH-300,r.text="总价：",e.addChild(r);var h=new egret.TextField;return h.x=r.x+90,h.y=StageUtils.SH-300,h.textColor=16758400,e.addChild(h),o.text="300盒",h.text="￥500000.00",e.txtZongJi=o,e.txtZongJia=h,e.getData(),e}return __extends(e,t),e.prototype.getData=function(){var t=this;$.ajax({url:Main.USER_INFO_API,data:{type:"querysum",ticket:Main.USER_TICKET},success:function(e){0==e.result?(t.txtZongJi.text=e.sumcnt+"盒",t.txtZongJia.text="￥"+e.sumprice,t.parent.txtName.text="【账户名："+e.username+"】",t.setData(e.discount)):PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})},error:function(){PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},e.prototype.setData=function(t){if(t){var e=0;for(var i in t){var a=new DetailItem;a.setData(i,t[i]),a.x=0,a.y=385*e,this.container.addChild(a),e++}}},e}(egret.DisplayObjectContainer);__reflect(DetailView.prototype,"DetailView");var DownView=function(t){function e(){var e=t.call(this)||this,i=Global.createBitmapByName("select_tips1_png");e.addChild(i);var a=Global.createBitmapByName("select_down_bg_png");a.x=0,a.y=130,e.addChild(a);var s=Global.createBitmapByName("btn_select_sendmail_png");return s.x=316,s.y=263,e.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,e.sendHandler,e),e.txtMail=new egret.TextField,e.txtMail.width=260,e.txtMail.fontFamily="微软雅黑",e.txtMail.type=egret.TextFieldType.INPUT,e.txtMail.x=40,e.txtMail.y=283,e.txtMail.text="请输入邮箱帐号",e.txtMail.size=24,e.txtMail.textColor=12830150,e.txtMail.maxChars=50,e.addChild(e.txtMail),e.txtMail.addEventListener(egret.FocusEvent.FOCUS_IN,e.mailFocusInHandler,e),e.txtMail.addEventListener(egret.FocusEvent.FOCUS_OUT,e.mailFocusOutHandler,e),e}return __extends(e,t),e.prototype.downHandler=function(){},e.prototype.downloadFile=function(t){try{var e=document.createElement("iframe");e.src=t,e.style.display="none",document.body.appendChild(e)}catch(i){}},e.prototype.sendHandler=function(){var t=this.txtMail.text;t&&"请输入邮箱帐号"!=t?Message.show("即将发送!"):Message.show("请输入邮箱帐号!")},e.prototype.mailFocusInHandler=function(){"请输入邮箱帐号"==this.txtMail.text&&(this.txtMail.text="")},e.prototype.mailFocusOutHandler=function(){""==this.txtMail.text&&(this.txtMail.text="请输入邮箱帐号")},e}(egret.DisplayObjectContainer);__reflect(DownView.prototype,"DownView");var SelectLoginPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.loginOK=function(){PopManager.hidePop("SelectLoginPop"),PopManager.showPop("SelectPop")},e}(LoginPop);__reflect(SelectLoginPop.prototype,"SelectLoginPop");var SelectPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new egret.Shape;i.graphics.beginFill(16777215),i.graphics.drawRect(0,0,StageUtils.SW,StageUtils.SH),i.graphics.endFill(),this.addChild(i),this.initContent()},e.prototype.initContent=function(){this.sp1=new egret.Sprite,this.sp1.graphics.beginFill(0,.001),this.sp1.graphics.drawRect(0,0,320,95),this.sp1.graphics.endFill(),this.addChild(this.sp1),this.txtContent1=new egret.TextField,this.txtContent1.text="付款明细",this.txtContent1.size=36,this.txtContent1.x=this.sp1.width-this.txtContent1.width>>1,this.txtContent1.y=this.sp1.height-this.txtContent1.height>>1,this.txtContent1.textColor=16730368,this.sp1.addChild(this.txtContent1),this.sp2=new egret.Sprite,this.sp2.graphics.beginFill(0,.001),this.sp2.graphics.drawRect(0,0,320,95),this.sp2.graphics.endFill(),this.sp2.x=320,this.addChild(this.sp2),this.txtContent2=new egret.TextField,this.txtContent2.text="下载表格",this.txtContent2.size=36,this.txtContent2.x=this.sp2.width-this.txtContent2.width>>1,this.txtContent2.y=this.sp2.height-this.txtContent2.height>>1,this.txtContent2.textColor=3291453,this.sp2.addChild(this.txtContent2),this.sp1.touchEnabled=!0,this.sp2.touchEnabled=!0,this.sp1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.spHandler,this),this.sp2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.spHandler,this);var t=Global.createBitmapByName("line_2_png");t.x=0,t.y=91,this.addChild(t),this.line1=Global.createBitmapByName("line_1_png"),this.line1.x=0,this.line1.y=95,this.addChild(this.line1),this.txtName=new egret.TextField,this.txtName.width=StageUtils.SW,this.txtName.x=0,this.txtName.y=150,this.txtName.textColor=469575,this.txtName.textAlign="center",this.addChild(this.txtName),this.txtName.text="【账户名：华美】",this.showView(0)},e.prototype.spHandler=function(t){t.target==this.sp1?(this.txtContent1.textColor=16730368,this.txtContent2.textColor=3291453,this.line1.x=0,this.showView(0)):(this.txtContent1.textColor=3291453,this.txtContent2.textColor=16730368,this.line1.x=320,this.showView(1))},e.prototype.showView=function(t){0==t?(this.detail||(this.detail=new DetailView,this.detail.x=StageUtils.SW-this.detail.width>>1,this.detail.y=240,this.addChild(this.detail)),this.detail.visible=!0,this.down&&(this.down.visible=!1)):(this.down||(this.down=new DownView,this.down.x=StageUtils.SW-this.down.width>>1,this.down.y=240,this.addChild(this.down)),this.down.visible=!0,this.detail&&(this.detail.visible=!1))},e}(PopView);__reflect(SelectPop.prototype,"SelectPop");